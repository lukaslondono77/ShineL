{"ast":null,"code":"var _jsxFileName = \"/Users/lukasygina/image-share-app-1/client/src/pages/Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Container, Grid, Paper, Typography, Box, TextField, Button, List, ListItem, ListItemText, Divider, IconButton, Avatar, Dialog, DialogTitle, DialogContent, ListItemAvatar, useMediaQuery, useTheme, AppBar, Toolbar, ToggleButton, ToggleButtonGroup } from '@mui/material';\nimport { Send as SendIcon, People as PeopleIcon, Close as CloseIcon, ArrowBack as ArrowBackIcon, Mic as MicIcon, Keyboard as KeyboardIcon } from '@mui/icons-material';\nimport axios from 'axios';\nimport { useAuth } from '../context/AuthContext';\nimport io from 'socket.io-client';\nimport PWAInstallPrompt from '../components/PWAInstallPrompt';\nimport AudioRecorder from '../components/AudioRecorder';\nimport AudioMessage from '../components/AudioMessage';\nimport API_URL from '../utils/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Chat = () => {\n  _s();\n  var _socketRef$current2, _selectedChat$partici2;\n  const {\n    user\n  } = useAuth();\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\n  const [chats, setChats] = useState([]);\n  const [selectedChat, setSelectedChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [showParticipants, setShowParticipants] = useState(false);\n  const [inputMode, setInputMode] = useState('text'); // 'text' or 'audio'\n  const messagesEndRef = useRef();\n  const socketRef = useRef();\n  const messageListenerRegistered = useRef(false);\n  useEffect(() => {\n    fetchChats();\n    const SOCKET_URL = process.env.REACT_APP_API_URL || 'https://chat-app-backend-6e9b.onrender.com';\n    console.log('🔄 Component mounting - Creating Socket.IO connection to:', SOCKET_URL);\n    socketRef.current = io(SOCKET_URL);\n    socketRef.current.on('connect', () => {\n      console.log('✅ Socket.IO connected with ID:', socketRef.current.id);\n    });\n    socketRef.current.on('disconnect', () => {\n      console.log('❌ Socket.IO disconnected');\n    });\n    return () => {\n      console.log('🔄 Component unmounting - Cleaning up Socket.IO connection');\n      if (socketRef.current) {\n        socketRef.current.disconnect();\n      }\n    };\n  }, []);\n  useEffect(() => {\n    if (chats.length > 0 && !selectedChat) {\n      // Automatically select the first (and only) chat (Global Chat)\n      setSelectedChat(chats[0]);\n    }\n  }, [chats, selectedChat]);\n  useEffect(() => {\n    if (selectedChat) {\n      fetchMessages(selectedChat._id);\n      socketRef.current.emit('join', selectedChat._id);\n    }\n    return () => {\n      if (selectedChat) {\n        socketRef.current.emit('leave', selectedChat._id);\n      }\n    };\n  }, [selectedChat, isMobile]);\n  useEffect(() => {\n    // Only register listener once when socket is available\n    if (!socketRef.current || messageListenerRegistered.current) {\n      console.log('🚫 Skipping message listener registration:', {\n        socketExists: !!socketRef.current,\n        alreadyRegistered: messageListenerRegistered.current\n      });\n      return;\n    }\n    console.log('🎯 Registering message listener for the first time - Socket ID:', socketRef.current.id);\n    messageListenerRegistered.current = true;\n    socketRef.current.on('message', message => {\n      var _message$sender, _socketRef$current;\n      console.log('📨 Received message via Socket.IO:', {\n        id: message._id,\n        content: message.content,\n        audioUrl: message.audioUrl,\n        messageType: message.messageType,\n        sender: (_message$sender = message.sender) === null || _message$sender === void 0 ? void 0 : _message$sender.username,\n        timestamp: new Date().toISOString(),\n        socketId: (_socketRef$current = socketRef.current) === null || _socketRef$current === void 0 ? void 0 : _socketRef$current.id\n      });\n      if (message && message.sender && (message.content || message.audioUrl)) {\n        setMessages(prev => {\n          // Check if message already exists to prevent duplicates\n          const messageExists = prev.some(msg => msg._id === message._id);\n          if (messageExists) {\n            console.log('🚫 Message already exists, not adding duplicate:', message._id);\n            return prev;\n          }\n          console.log('✅ Adding new message to state:', message._id);\n          return [...prev, message];\n        });\n      } else {\n        console.error('❌ Invalid message structure received:', message);\n      }\n    });\n\n    // Cleanup function\n    return () => {\n      if (socketRef.current) {\n        console.log('🧹 Cleaning up message listener for socket:', socketRef.current.id);\n        socketRef.current.off('message');\n        messageListenerRegistered.current = false;\n      }\n    };\n  }, [(_socketRef$current2 = socketRef.current) === null || _socketRef$current2 === void 0 ? void 0 : _socketRef$current2.connected]);\n  const fetchChats = async () => {\n    try {\n      const res = await axios.get('/api/chats');\n      setChats(res.data);\n    } catch (error) {\n      console.error('Error fetching chats:', error);\n    }\n  };\n  const fetchMessages = async chatId => {\n    try {\n      const res = await axios.get(`/api/chats/${chatId}`);\n      setMessages(res.data.messages);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n  const handleSendMessage = async e => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n    console.log('Sending message:', {\n      content: newMessage,\n      chatId: selectedChat._id,\n      userId: user._id\n    });\n    try {\n      const res = await axios.post(`/api/chats/${selectedChat._id}/messages`, {\n        content: newMessage\n      });\n      console.log('Message sent successfully via HTTP:', res.data);\n\n      // Don't manually add the message here - let Socket.IO handle it\n      // setMessages((prev) => [...prev, res.data]);\n      setNewMessage('');\n\n      // Don't emit via Socket.IO - the backend will handle this\n      // socketRef.current.emit('message', {\n      //   chatId: selectedChat._id,\n      //   message: res.data\n      // });\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n  const handleSendAudio = async (audioUrl, duration) => {\n    try {\n      console.log('Sending audio message:', {\n        audioUrl,\n        duration,\n        chatId: selectedChat._id\n      });\n      const res = await axios.post(`${API_URL}/api/audio/chats/${selectedChat._id}/audio`, {\n        audioUrl,\n        audioDuration: duration\n      });\n      console.log('Audio message sent successfully:', res.data);\n    } catch (error) {\n      console.error('Error sending audio message:', error);\n      if (error.response) {\n        console.error('Error response:', error.response.data);\n        console.error('Error status:', error.response.status);\n      }\n    }\n  };\n  const renderMessage = message => {\n    // Add null checks to prevent errors\n    if (!message || !message.sender || !user) {\n      return null;\n    }\n    const isOwnMessage = message.sender._id === user._id;\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        justifyContent: isOwnMessage ? 'flex-end' : 'flex-start',\n        mb: 2,\n        px: 1\n      },\n      children: /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          maxWidth: isMobile ? '80%' : '60%',\n          display: 'flex',\n          flexDirection: isOwnMessage ? 'row-reverse' : 'row',\n          alignItems: 'flex-end',\n          gap: 1\n        },\n        children: [!isOwnMessage && /*#__PURE__*/_jsxDEV(Avatar, {\n          sx: {\n            width: 32,\n            height: 32,\n            bgcolor: 'primary.main',\n            fontSize: '0.875rem'\n          },\n          children: message.sender.username[0].toUpperCase()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: isOwnMessage ? 'flex-end' : 'flex-start',\n            maxWidth: '100%'\n          },\n          children: [!isOwnMessage && /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"caption\",\n            sx: {\n              color: 'text.secondary',\n              mb: 0.5,\n              fontSize: '0.75rem'\n            },\n            children: message.sender.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 15\n          }, this), message.messageType === 'audio' ? /*#__PURE__*/_jsxDEV(AudioMessage, {\n            audioUrl: message.audioUrl,\n            duration: message.audioDuration,\n            isOwnMessage: isOwnMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(Paper, {\n            elevation: 1,\n            sx: {\n              p: 1.5,\n              bgcolor: isOwnMessage ? 'primary.main' : 'background.paper',\n              color: isOwnMessage ? 'primary.contrastText' : 'text.primary',\n              borderRadius: 2,\n              border: 1,\n              borderColor: isOwnMessage ? 'primary.main' : 'divider',\n              wordBreak: 'break-word',\n              maxWidth: '100%'\n            },\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"caption\",\n            sx: {\n              color: 'text.secondary',\n              mt: 0.5,\n              fontSize: '0.7rem'\n            },\n            children: new Date(message.createdAt).toLocaleTimeString([], {\n              hour: '2-digit',\n              minute: '2-digit'\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }, this)\n    }, message._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }, this);\n  };\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  if (isMobile) {\n    var _selectedChat$partici;\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        height: '100vh',\n        display: 'flex',\n        flexDirection: 'column'\n      },\n      children: [/*#__PURE__*/_jsxDEV(AppBar, {\n        position: \"static\",\n        children: /*#__PURE__*/_jsxDEV(Toolbar, {\n          children: [/*#__PURE__*/_jsxDEV(IconButton, {\n            edge: \"start\",\n            color: \"inherit\",\n            onClick: () => window.history.back(),\n            children: /*#__PURE__*/_jsxDEV(ArrowBackIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            variant: \"h6\",\n            sx: {\n              flexGrow: 1\n            },\n            children: (selectedChat === null || selectedChat === void 0 ? void 0 : selectedChat.name) || 'Chat'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            color: \"inherit\",\n            onClick: () => setShowParticipants(true),\n            children: /*#__PURE__*/_jsxDEV(PeopleIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          flexGrow: 1,\n          overflowY: 'auto',\n          p: 1,\n          bgcolor: 'background.default'\n        },\n        children: [messages.map(renderMessage), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          p: 2,\n          bgcolor: 'background.paper',\n          borderTop: 1,\n          borderColor: 'divider'\n        },\n        children: inputMode === 'text' ? /*#__PURE__*/_jsxDEV(Box, {\n          component: \"form\",\n          onSubmit: handleSendMessage,\n          sx: {\n            display: 'flex',\n            gap: 1\n          },\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            fullWidth: true,\n            size: \"small\",\n            placeholder: \"Escribe un mensaje...\",\n            value: newMessage,\n            onChange: e => setNewMessage(e.target.value),\n            sx: {\n              flexGrow: 1\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            type: \"submit\",\n            color: \"primary\",\n            disabled: !newMessage.trim(),\n            sx: {\n              bgcolor: 'primary.main',\n              color: 'white',\n              '&:hover': {\n                bgcolor: 'primary.dark'\n              }\n            },\n            children: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 395,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n            onClick: () => setInputMode('audio'),\n            color: \"primary\",\n            children: /*#__PURE__*/_jsxDEV(MicIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            flexDirection: 'column',\n            gap: 1\n          },\n          children: [/*#__PURE__*/_jsxDEV(AudioRecorder, {\n            onSendAudio: handleSendAudio\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              display: 'flex',\n              justifyContent: 'center'\n            },\n            children: /*#__PURE__*/_jsxDEV(IconButton, {\n              onClick: () => setInputMode('text'),\n              color: \"primary\",\n              children: /*#__PURE__*/_jsxDEV(KeyboardIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 412,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 408,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n        open: showParticipants,\n        onClose: () => setShowParticipants(false),\n        fullWidth: true,\n        maxWidth: \"sm\",\n        children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n          children: [\"Participantes\", /*#__PURE__*/_jsxDEV(IconButton, {\n            onClick: () => setShowParticipants(false),\n            sx: {\n              position: 'absolute',\n              right: 8,\n              top: 8\n            },\n            children: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n          children: /*#__PURE__*/_jsxDEV(List, {\n            children: selectedChat === null || selectedChat === void 0 ? void 0 : (_selectedChat$partici = selectedChat.participants) === null || _selectedChat$partici === void 0 ? void 0 : _selectedChat$partici.map(participant => /*#__PURE__*/_jsxDEV(ListItem, {\n              children: [/*#__PURE__*/_jsxDEV(ListItemAvatar, {\n                children: /*#__PURE__*/_jsxDEV(Avatar, {\n                  children: participant.username[0].toUpperCase()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 440,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 439,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n                primary: participant.username\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 19\n              }, this)]\n            }, participant._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(PWAInstallPrompt, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Desktop layout\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    sx: {\n      mt: 2,\n      mb: 2,\n      height: 'calc(100vh - 100px)'\n    },\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      sx: {\n        height: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        md: 4,\n        children: /*#__PURE__*/_jsxDEV(Paper, {\n          sx: {\n            height: '100%',\n            overflow: 'hidden'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              p: 2,\n              borderBottom: 1,\n              borderColor: 'divider'\n            },\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h6\",\n              children: \"Chats\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 464,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(List, {\n            sx: {\n              overflowY: 'auto',\n              maxHeight: 'calc(100% - 70px)'\n            },\n            children: chats.map(chat => {\n              var _chat$participants;\n              return /*#__PURE__*/_jsxDEV(ListItem, {\n                button: true,\n                selected: (selectedChat === null || selectedChat === void 0 ? void 0 : selectedChat._id) === chat._id,\n                onClick: () => setSelectedChat(chat),\n                children: [/*#__PURE__*/_jsxDEV(ListItemAvatar, {\n                  children: /*#__PURE__*/_jsxDEV(Avatar, {\n                    children: chat.name[0].toUpperCase()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 475,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 474,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n                  primary: chat.name,\n                  secondary: `${((_chat$participants = chat.participants) === null || _chat$participants === void 0 ? void 0 : _chat$participants.length) || 0} participantes`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 479,\n                  columnNumber: 19\n                }, this)]\n              }, chat._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 468,\n                columnNumber: 17\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 461,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        md: 8,\n        children: /*#__PURE__*/_jsxDEV(Paper, {\n          sx: {\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'column'\n          },\n          children: [/*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              p: 2,\n              borderBottom: 1,\n              borderColor: 'divider',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'space-between'\n            },\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"h6\",\n              children: (selectedChat === null || selectedChat === void 0 ? void 0 : selectedChat.name) || 'Selecciona un chat'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 494,\n              columnNumber: 15\n            }, this), selectedChat && /*#__PURE__*/_jsxDEV(IconButton, {\n              onClick: () => setShowParticipants(true),\n              size: \"small\",\n              children: /*#__PURE__*/_jsxDEV(PeopleIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 498,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              flexGrow: 1,\n              overflowY: 'auto',\n              p: 2,\n              bgcolor: 'background.default'\n            },\n            children: [selectedChat ? messages.map(renderMessage) : /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                textAlign: 'center',\n                mt: 4\n              },\n              children: /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h6\",\n                color: \"text.secondary\",\n                children: \"Selecciona un chat para comenzar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 520,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: messagesEndRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 525,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 13\n          }, this), selectedChat && /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              p: 2,\n              borderTop: 1,\n              borderColor: 'divider'\n            },\n            children: [/*#__PURE__*/_jsxDEV(ToggleButtonGroup, {\n              value: inputMode,\n              exclusive: true,\n              onChange: (e, newMode) => newMode && setInputMode(newMode),\n              size: \"small\",\n              sx: {\n                mb: 1\n              },\n              children: [/*#__PURE__*/_jsxDEV(ToggleButton, {\n                value: \"text\",\n                children: /*#__PURE__*/_jsxDEV(KeyboardIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 539,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 538,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(ToggleButton, {\n                value: \"audio\",\n                children: /*#__PURE__*/_jsxDEV(MicIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 542,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 541,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 531,\n              columnNumber: 17\n            }, this), inputMode === 'text' ? /*#__PURE__*/_jsxDEV(Box, {\n              component: \"form\",\n              onSubmit: handleSendMessage,\n              sx: {\n                display: 'flex',\n                gap: 1\n              },\n              children: [/*#__PURE__*/_jsxDEV(TextField, {\n                fullWidth: true,\n                size: \"small\",\n                placeholder: \"Escribe un mensaje...\",\n                value: newMessage,\n                onChange: e => setNewMessage(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 548,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                type: \"submit\",\n                variant: \"contained\",\n                disabled: !newMessage.trim(),\n                startIcon: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 559,\n                  columnNumber: 34\n                }, this),\n                children: \"Enviar\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 555,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 547,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(AudioRecorder, {\n              onSendAudio: handleSendAudio\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 565,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: showParticipants,\n      onClose: () => setShowParticipants(false),\n      maxWidth: \"sm\",\n      fullWidth: true,\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: [\"Participantes\", /*#__PURE__*/_jsxDEV(IconButton, {\n          onClick: () => setShowParticipants(false),\n          sx: {\n            position: 'absolute',\n            right: 8,\n            top: 8\n          },\n          children: /*#__PURE__*/_jsxDEV(CloseIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 586,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 580,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(List, {\n          children: selectedChat === null || selectedChat === void 0 ? void 0 : (_selectedChat$partici2 = selectedChat.participants) === null || _selectedChat$partici2 === void 0 ? void 0 : _selectedChat$partici2.map(participant => /*#__PURE__*/_jsxDEV(ListItem, {\n            children: [/*#__PURE__*/_jsxDEV(ListItemAvatar, {\n              children: /*#__PURE__*/_jsxDEV(Avatar, {\n                children: participant.username[0].toUpperCase()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 594,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 593,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n              primary: participant.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 598,\n              columnNumber: 17\n            }, this)]\n          }, participant._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 592,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 589,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 574,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PWAInstallPrompt, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 605,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 458,\n    columnNumber: 5\n  }, this);\n};\n_s(Chat, \"5xii7G+yZJLEQmoNj4KpAv9n8C0=\", false, function () {\n  return [useAuth, useTheme, useMediaQuery];\n});\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Container","Grid","Paper","Typography","Box","TextField","Button","List","ListItem","ListItemText","Divider","IconButton","Avatar","Dialog","DialogTitle","DialogContent","ListItemAvatar","useMediaQuery","useTheme","AppBar","Toolbar","ToggleButton","ToggleButtonGroup","Send","SendIcon","People","PeopleIcon","Close","CloseIcon","ArrowBack","ArrowBackIcon","Mic","MicIcon","Keyboard","KeyboardIcon","axios","useAuth","io","PWAInstallPrompt","AudioRecorder","AudioMessage","API_URL","jsxDEV","_jsxDEV","Chat","_s","_socketRef$current2","_selectedChat$partici2","user","theme","isMobile","breakpoints","down","chats","setChats","selectedChat","setSelectedChat","messages","setMessages","newMessage","setNewMessage","showParticipants","setShowParticipants","inputMode","setInputMode","messagesEndRef","socketRef","messageListenerRegistered","fetchChats","SOCKET_URL","process","env","REACT_APP_API_URL","console","log","current","on","id","disconnect","length","fetchMessages","_id","emit","socketExists","alreadyRegistered","message","_message$sender","_socketRef$current","content","audioUrl","messageType","sender","username","timestamp","Date","toISOString","socketId","prev","messageExists","some","msg","error","off","connected","res","get","data","chatId","handleSendMessage","e","preventDefault","trim","userId","post","handleSendAudio","duration","audioDuration","response","status","renderMessage","isOwnMessage","sx","display","justifyContent","mb","px","children","maxWidth","flexDirection","alignItems","gap","width","height","bgcolor","fontSize","toUpperCase","fileName","_jsxFileName","lineNumber","columnNumber","variant","color","elevation","p","borderRadius","border","borderColor","wordBreak","mt","createdAt","toLocaleTimeString","hour","minute","scrollToBottom","_messagesEndRef$curre","scrollIntoView","behavior","_selectedChat$partici","position","edge","onClick","window","history","back","flexGrow","name","overflowY","map","ref","borderTop","component","onSubmit","fullWidth","size","placeholder","value","onChange","target","type","disabled","onSendAudio","open","onClose","right","top","participants","participant","primary","container","spacing","item","xs","md","overflow","borderBottom","maxHeight","chat","_chat$participants","button","selected","secondary","textAlign","exclusive","newMode","startIcon","_c","$RefreshReg$"],"sources":["/Users/lukasygina/image-share-app-1/client/src/pages/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Container,\n  Grid,\n  Paper,\n  Typography,\n  Box,\n  TextField,\n  Button,\n  List,\n  ListItem,\n  ListItemText,\n  Divider,\n  IconButton,\n  Avatar,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  ListItemAvatar,\n  useMediaQuery,\n  useTheme,\n  AppBar,\n  Toolbar,\n  ToggleButton,\n  ToggleButtonGroup\n} from '@mui/material';\nimport {\n  Send as SendIcon,\n  People as PeopleIcon,\n  Close as CloseIcon,\n  ArrowBack as ArrowBackIcon,\n  Mic as MicIcon,\n  Keyboard as KeyboardIcon\n} from '@mui/icons-material';\nimport axios from 'axios';\nimport { useAuth } from '../context/AuthContext';\nimport io from 'socket.io-client';\nimport PWAInstallPrompt from '../components/PWAInstallPrompt';\nimport AudioRecorder from '../components/AudioRecorder';\nimport AudioMessage from '../components/AudioMessage';\nimport API_URL from '../utils/api';\n\nconst Chat = () => {\n  const { user } = useAuth();\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\n  \n  const [chats, setChats] = useState([]);\n  const [selectedChat, setSelectedChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [showParticipants, setShowParticipants] = useState(false);\n  const [inputMode, setInputMode] = useState('text'); // 'text' or 'audio'\n  const messagesEndRef = useRef();\n  const socketRef = useRef();\n  const messageListenerRegistered = useRef(false);\n\n  useEffect(() => {\n    fetchChats();\n    const SOCKET_URL = process.env.REACT_APP_API_URL || 'https://chat-app-backend-6e9b.onrender.com';\n    \n    console.log('🔄 Component mounting - Creating Socket.IO connection to:', SOCKET_URL);\n    socketRef.current = io(SOCKET_URL);\n\n    socketRef.current.on('connect', () => {\n      console.log('✅ Socket.IO connected with ID:', socketRef.current.id);\n    });\n\n    socketRef.current.on('disconnect', () => {\n      console.log('❌ Socket.IO disconnected');\n    });\n\n    return () => {\n      console.log('🔄 Component unmounting - Cleaning up Socket.IO connection');\n      if (socketRef.current) {\n        socketRef.current.disconnect();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (chats.length > 0 && !selectedChat) {\n      // Automatically select the first (and only) chat (Global Chat)\n      setSelectedChat(chats[0]);\n    }\n  }, [chats, selectedChat]);\n\n  useEffect(() => {\n    if (selectedChat) {\n      fetchMessages(selectedChat._id);\n      socketRef.current.emit('join', selectedChat._id);\n    }\n\n    return () => {\n      if (selectedChat) {\n        socketRef.current.emit('leave', selectedChat._id);\n      }\n    };\n  }, [selectedChat, isMobile]);\n\n  useEffect(() => {\n    // Only register listener once when socket is available\n    if (!socketRef.current || messageListenerRegistered.current) {\n      console.log('🚫 Skipping message listener registration:', {\n        socketExists: !!socketRef.current,\n        alreadyRegistered: messageListenerRegistered.current\n      });\n      return;\n    }\n\n    console.log('🎯 Registering message listener for the first time - Socket ID:', socketRef.current.id);\n    messageListenerRegistered.current = true;\n    \n    socketRef.current.on('message', (message) => {\n      console.log('📨 Received message via Socket.IO:', {\n        id: message._id,\n        content: message.content,\n        audioUrl: message.audioUrl,\n        messageType: message.messageType,\n        sender: message.sender?.username,\n        timestamp: new Date().toISOString(),\n        socketId: socketRef.current?.id\n      });\n      \n      if (message && message.sender && (message.content || message.audioUrl)) {\n        setMessages((prev) => {\n          // Check if message already exists to prevent duplicates\n          const messageExists = prev.some(msg => msg._id === message._id);\n          if (messageExists) {\n            console.log('🚫 Message already exists, not adding duplicate:', message._id);\n            return prev;\n          }\n          \n          console.log('✅ Adding new message to state:', message._id);\n          return [...prev, message];\n        });\n      } else {\n        console.error('❌ Invalid message structure received:', message);\n      }\n    });\n\n    // Cleanup function\n    return () => {\n      if (socketRef.current) {\n        console.log('🧹 Cleaning up message listener for socket:', socketRef.current.id);\n        socketRef.current.off('message');\n        messageListenerRegistered.current = false;\n      }\n    };\n  }, [socketRef.current?.connected]);\n\n  const fetchChats = async () => {\n    try {\n      const res = await axios.get('/api/chats');\n      setChats(res.data);\n    } catch (error) {\n      console.error('Error fetching chats:', error);\n    }\n  };\n\n  const fetchMessages = async (chatId) => {\n    try {\n      const res = await axios.get(`/api/chats/${chatId}`);\n      setMessages(res.data.messages);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    console.log('Sending message:', {\n      content: newMessage,\n      chatId: selectedChat._id,\n      userId: user._id\n    });\n\n    try {\n      const res = await axios.post(`/api/chats/${selectedChat._id}/messages`, {\n        content: newMessage\n      });\n      \n      console.log('Message sent successfully via HTTP:', res.data);\n      \n      // Don't manually add the message here - let Socket.IO handle it\n      // setMessages((prev) => [...prev, res.data]);\n      setNewMessage('');\n\n      // Don't emit via Socket.IO - the backend will handle this\n      // socketRef.current.emit('message', {\n      //   chatId: selectedChat._id,\n      //   message: res.data\n      // });\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const handleSendAudio = async (audioUrl, duration) => {\n    try {\n      console.log('Sending audio message:', {\n        audioUrl,\n        duration,\n        chatId: selectedChat._id\n      });\n\n      const res = await axios.post(`${API_URL}/api/audio/chats/${selectedChat._id}/audio`, {\n        audioUrl,\n        audioDuration: duration\n      });\n      \n      console.log('Audio message sent successfully:', res.data);\n      \n    } catch (error) {\n      console.error('Error sending audio message:', error);\n      if (error.response) {\n        console.error('Error response:', error.response.data);\n        console.error('Error status:', error.response.status);\n      }\n    }\n  };\n\n  const renderMessage = (message) => {\n    // Add null checks to prevent errors\n    if (!message || !message.sender || !user) {\n      return null;\n    }\n    \n    const isOwnMessage = message.sender._id === user._id;\n    \n    return (\n      <Box\n        key={message._id}\n        sx={{\n          display: 'flex',\n          justifyContent: isOwnMessage ? 'flex-end' : 'flex-start',\n          mb: 2,\n          px: 1\n        }}\n      >\n        <Box\n          sx={{\n            maxWidth: isMobile ? '80%' : '60%',\n            display: 'flex',\n            flexDirection: isOwnMessage ? 'row-reverse' : 'row',\n            alignItems: 'flex-end',\n            gap: 1\n          }}\n        >\n          {!isOwnMessage && (\n            <Avatar\n              sx={{\n                width: 32,\n                height: 32,\n                bgcolor: 'primary.main',\n                fontSize: '0.875rem'\n              }}\n            >\n              {message.sender.username[0].toUpperCase()}\n            </Avatar>\n          )}\n          \n          <Box\n            sx={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: isOwnMessage ? 'flex-end' : 'flex-start',\n              maxWidth: '100%'\n            }}\n          >\n            {!isOwnMessage && (\n              <Typography\n                variant=\"caption\"\n                sx={{\n                  color: 'text.secondary',\n                  mb: 0.5,\n                  fontSize: '0.75rem'\n                }}\n              >\n                {message.sender.username}\n              </Typography>\n            )}\n            \n            {message.messageType === 'audio' ? (\n              <AudioMessage\n                audioUrl={message.audioUrl}\n                duration={message.audioDuration}\n                isOwnMessage={isOwnMessage}\n              />\n            ) : (\n              <Paper\n                elevation={1}\n                sx={{\n                  p: 1.5,\n                  bgcolor: isOwnMessage ? 'primary.main' : 'background.paper',\n                  color: isOwnMessage ? 'primary.contrastText' : 'text.primary',\n                  borderRadius: 2,\n                  border: 1,\n                  borderColor: isOwnMessage ? 'primary.main' : 'divider',\n                  wordBreak: 'break-word',\n                  maxWidth: '100%'\n                }}\n              >\n                <Typography variant=\"body2\">\n                  {message.content}\n                </Typography>\n              </Paper>\n            )}\n            \n            <Typography\n              variant=\"caption\"\n              sx={{\n                color: 'text.secondary',\n                mt: 0.5,\n                fontSize: '0.7rem'\n              }}\n            >\n              {new Date(message.createdAt).toLocaleTimeString([], {\n                hour: '2-digit',\n                minute: '2-digit'\n              })}\n            </Typography>\n          </Box>\n        </Box>\n      </Box>\n    );\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  if (isMobile) {\n    return (\n      <Box sx={{ height: '100vh', display: 'flex', flexDirection: 'column' }}>\n        {/* Mobile Header */}\n        <AppBar position=\"static\">\n          <Toolbar>\n            <IconButton\n              edge=\"start\"\n              color=\"inherit\"\n              onClick={() => window.history.back()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n            <Typography variant=\"h6\" sx={{ flexGrow: 1 }}>\n              {selectedChat?.name || 'Chat'}\n            </Typography>\n            <IconButton\n              color=\"inherit\"\n              onClick={() => setShowParticipants(true)}\n            >\n              <PeopleIcon />\n            </IconButton>\n          </Toolbar>\n        </AppBar>\n\n        {/* Messages Area */}\n        <Box\n          sx={{\n            flexGrow: 1,\n            overflowY: 'auto',\n            p: 1,\n            bgcolor: 'background.default'\n          }}\n        >\n          {messages.map(renderMessage)}\n          <div ref={messagesEndRef} />\n        </Box>\n\n        {/* Input Area */}\n        <Box sx={{ p: 2, bgcolor: 'background.paper', borderTop: 1, borderColor: 'divider' }}>\n          {inputMode === 'text' ? (\n            <Box component=\"form\" onSubmit={handleSendMessage} sx={{ display: 'flex', gap: 1 }}>\n              <TextField\n                fullWidth\n                size=\"small\"\n                placeholder=\"Escribe un mensaje...\"\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                sx={{ flexGrow: 1 }}\n              />\n              <IconButton\n                type=\"submit\"\n                color=\"primary\"\n                disabled={!newMessage.trim()}\n                sx={{ bgcolor: 'primary.main', color: 'white', '&:hover': { bgcolor: 'primary.dark' } }}\n              >\n                <SendIcon />\n              </IconButton>\n              <IconButton\n                onClick={() => setInputMode('audio')}\n                color=\"primary\"\n              >\n                <MicIcon />\n              </IconButton>\n            </Box>\n          ) : (\n            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n              <AudioRecorder onSendAudio={handleSendAudio} />\n              <Box sx={{ display: 'flex', justifyContent: 'center' }}>\n                <IconButton\n                  onClick={() => setInputMode('text')}\n                  color=\"primary\"\n                >\n                  <KeyboardIcon />\n                </IconButton>\n              </Box>\n            </Box>\n          )}\n        </Box>\n\n        {/* Participants Dialog */}\n        <Dialog\n          open={showParticipants}\n          onClose={() => setShowParticipants(false)}\n          fullWidth\n          maxWidth=\"sm\"\n        >\n          <DialogTitle>\n            Participantes\n            <IconButton\n              onClick={() => setShowParticipants(false)}\n              sx={{ position: 'absolute', right: 8, top: 8 }}\n            >\n              <CloseIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent>\n            <List>\n              {selectedChat?.participants?.map((participant) => (\n                <ListItem key={participant._id}>\n                  <ListItemAvatar>\n                    <Avatar>\n                      {participant.username[0].toUpperCase()}\n                    </Avatar>\n                  </ListItemAvatar>\n                  <ListItemText primary={participant.username} />\n                </ListItem>\n              ))}\n            </List>\n          </DialogContent>\n        </Dialog>\n\n        <PWAInstallPrompt />\n      </Box>\n    );\n  }\n\n  // Desktop layout\n  return (\n    <Container maxWidth=\"lg\" sx={{ mt: 2, mb: 2, height: 'calc(100vh - 100px)' }}>\n      <Grid container spacing={2} sx={{ height: '100%' }}>\n        {/* Chat List */}\n        <Grid item xs={12} md={4}>\n          <Paper sx={{ height: '100%', overflow: 'hidden' }}>\n            <Box sx={{ p: 2, borderBottom: 1, borderColor: 'divider' }}>\n              <Typography variant=\"h6\">Chats</Typography>\n            </Box>\n            <List sx={{ overflowY: 'auto', maxHeight: 'calc(100% - 70px)' }}>\n              {chats.map((chat) => (\n                <ListItem\n                  key={chat._id}\n                  button\n                  selected={selectedChat?._id === chat._id}\n                  onClick={() => setSelectedChat(chat)}\n                >\n                  <ListItemAvatar>\n                    <Avatar>\n                      {chat.name[0].toUpperCase()}\n                    </Avatar>\n                  </ListItemAvatar>\n                  <ListItemText\n                    primary={chat.name}\n                    secondary={`${chat.participants?.length || 0} participantes`}\n                  />\n                </ListItem>\n              ))}\n            </List>\n          </Paper>\n        </Grid>\n\n        {/* Chat Area */}\n        <Grid item xs={12} md={8}>\n          <Paper sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n            {/* Chat Header */}\n            <Box sx={{ p: 2, borderBottom: 1, borderColor: 'divider', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n              <Typography variant=\"h6\">\n                {selectedChat?.name || 'Selecciona un chat'}\n              </Typography>\n              {selectedChat && (\n                <IconButton\n                  onClick={() => setShowParticipants(true)}\n                  size=\"small\"\n                >\n                  <PeopleIcon />\n                </IconButton>\n              )}\n            </Box>\n\n            {/* Messages Area */}\n            <Box\n              sx={{\n                flexGrow: 1,\n                overflowY: 'auto',\n                p: 2,\n                bgcolor: 'background.default'\n              }}\n            >\n              {selectedChat ? (\n                messages.map(renderMessage)\n              ) : (\n                <Box sx={{ textAlign: 'center', mt: 4 }}>\n                  <Typography variant=\"h6\" color=\"text.secondary\">\n                    Selecciona un chat para comenzar\n                  </Typography>\n                </Box>\n              )}\n              <div ref={messagesEndRef} />\n            </Box>\n\n            {/* Input Area */}\n            {selectedChat && (\n              <Box sx={{ p: 2, borderTop: 1, borderColor: 'divider' }}>\n                <ToggleButtonGroup\n                  value={inputMode}\n                  exclusive\n                  onChange={(e, newMode) => newMode && setInputMode(newMode)}\n                  size=\"small\"\n                  sx={{ mb: 1 }}\n                >\n                  <ToggleButton value=\"text\">\n                    <KeyboardIcon />\n                  </ToggleButton>\n                  <ToggleButton value=\"audio\">\n                    <MicIcon />\n                  </ToggleButton>\n                </ToggleButtonGroup>\n                \n                {inputMode === 'text' ? (\n                  <Box component=\"form\" onSubmit={handleSendMessage} sx={{ display: 'flex', gap: 1 }}>\n                    <TextField\n                      fullWidth\n                      size=\"small\"\n                      placeholder=\"Escribe un mensaje...\"\n                      value={newMessage}\n                      onChange={(e) => setNewMessage(e.target.value)}\n                    />\n                    <Button\n                      type=\"submit\"\n                      variant=\"contained\"\n                      disabled={!newMessage.trim()}\n                      startIcon={<SendIcon />}\n                    >\n                      Enviar\n                    </Button>\n                  </Box>\n                ) : (\n                  <AudioRecorder onSendAudio={handleSendAudio} />\n                )}\n              </Box>\n            )}\n          </Paper>\n        </Grid>\n      </Grid>\n\n      {/* Participants Dialog */}\n      <Dialog\n        open={showParticipants}\n        onClose={() => setShowParticipants(false)}\n        maxWidth=\"sm\"\n        fullWidth\n      >\n        <DialogTitle>\n          Participantes\n          <IconButton\n            onClick={() => setShowParticipants(false)}\n            sx={{ position: 'absolute', right: 8, top: 8 }}\n          >\n            <CloseIcon />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent>\n          <List>\n            {selectedChat?.participants?.map((participant) => (\n              <ListItem key={participant._id}>\n                <ListItemAvatar>\n                  <Avatar>\n                    {participant.username[0].toUpperCase()}\n                  </Avatar>\n                </ListItemAvatar>\n                <ListItemText primary={participant.username} />\n              </ListItem>\n            ))}\n          </List>\n        </DialogContent>\n      </Dialog>\n\n      <PWAInstallPrompt />\n    </Container>\n  );\n};\n\nexport default Chat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}