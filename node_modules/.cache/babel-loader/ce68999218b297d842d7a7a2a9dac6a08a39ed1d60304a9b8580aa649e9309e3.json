{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{Container,Grid,Paper,Typography,Box,TextField,Button,List,ListItem,ListItemText,Divider,IconButton,Avatar,Dialog,DialogTitle,DialogContent,ListItemAvatar,useMediaQuery,useTheme,AppBar,Toolbar}from'@mui/material';import{Send as SendIcon,AttachFile as AttachFileIcon,Image as ImageIcon,Videocam as VideoIcon,Mic as MicIcon,People as PeopleIcon,Close as CloseIcon,ArrowBack as ArrowBackIcon}from'@mui/icons-material';import axios from'axios';import{useAuth}from'../context/AuthContext';import{getFileUrl}from'../utils/api';import io from'socket.io-client';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Chat=()=>{const{user}=useAuth();const theme=useTheme();const isMobile=useMediaQuery(theme.breakpoints.down('md'));const[chats,setChats]=useState([]);const[selectedChat,setSelectedChat]=useState(null);const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[newChatName,setNewChatName]=useState('');const[participants,setParticipants]=useState([]);const[showParticipants,setShowParticipants]=useState(false);const[selectedFile,setSelectedFile]=useState(null);const[fileInputRef]=useState(useRef());const[selectedImage,setSelectedImage]=useState(null);const[showImageModal,setShowImageModal]=useState(false);const messagesEndRef=useRef();const socketRef=useRef();useEffect(()=>{fetchChats();const SOCKET_URL=process.env.REACT_APP_API_URL||'https://chat-app-backend-6e9b.onrender.com';socketRef.current=io(SOCKET_URL);return()=>{socketRef.current.disconnect();};},[]);useEffect(()=>{if(selectedChat){fetchMessages(selectedChat._id);fetchParticipants(selectedChat._id);socketRef.current.emit('join',selectedChat._id);}return()=>{if(selectedChat){socketRef.current.emit('leave',selectedChat._id);}};},[selectedChat,isMobile]);useEffect(()=>{socketRef.current.on('message',message=>{setMessages(prev=>[...prev,message]);});},[]);const fetchChats=async()=>{try{const res=await axios.get('/api/chats');setChats(res.data);}catch(error){console.error('Error fetching chats:',error);}};const fetchMessages=async chatId=>{try{const res=await axios.get(\"/api/chats/\".concat(chatId));setMessages(res.data.messages);}catch(error){console.error('Error fetching messages:',error);}};const fetchParticipants=async chatId=>{try{const res=await axios.get(\"/api/chats/\".concat(chatId,\"/participants\"));setParticipants(res.data);}catch(error){console.error('Error fetching participants:',error);}};const handleCreateChat=async()=>{try{await axios.post('/api/chats',{name:newChatName});setNewChatName('');fetchChats();}catch(error){console.error('Error creating chat:',error);}};const handleSendMessage=async e=>{e.preventDefault();if(!newMessage.trim()&&!selectedFile)return;try{let res;if(selectedFile){// Send media message\nconst formData=new FormData();formData.append('file',selectedFile);if(newMessage.trim()){formData.append('caption',newMessage);}res=await axios.post(\"/api/chats/\".concat(selectedChat._id,\"/media\"),formData,{headers:{'Content-Type':'multipart/form-data'}});setMessages(prev=>[...prev,res.data]);setSelectedFile(null);setNewMessage('');}else{// Send text message\nres=await axios.post(\"/api/chats/\".concat(selectedChat._id,\"/messages\"),{content:newMessage});setMessages(prev=>[...prev,res.data]);setNewMessage('');}socketRef.current.emit('message',{chatId:selectedChat._id,message:res.data});}catch(error){console.error('Error sending message:',error);}};const handleFileSelect=event=>{const file=event.target.files[0];if(file){setSelectedFile(file);}};const removeSelectedFile=()=>{setSelectedFile(null);if(fileInputRef.current){fileInputRef.current.value='';}};const handleImageClick=(imageUrl,caption)=>{setSelectedImage({url:imageUrl,caption});setShowImageModal(true);};const closeImageModal=()=>{setShowImageModal(false);setSelectedImage(null);};const getFileIcon=messageType=>{switch(messageType){case'image':return/*#__PURE__*/_jsx(ImageIcon,{});case'video':return/*#__PURE__*/_jsx(VideoIcon,{});case'audio':return/*#__PURE__*/_jsx(MicIcon,{});default:return/*#__PURE__*/_jsx(AttachFileIcon,{});}};const renderMessage=message=>{const isOwnMessage=message.sender._id===user._id;return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:isOwnMessage?'flex-end':'flex-start',mb:2,px:isMobile?1:2},children:/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:isMobile?'85%':'70%',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{mb:0.5,fontWeight:'bold',color:isOwnMessage?'primary.main':'text.secondary'},children:isOwnMessage?'TÃº':message.sender.username}),/*#__PURE__*/_jsx(Box,{sx:{bgcolor:isOwnMessage?'primary.main':'grey.200',color:isOwnMessage?'white':'text.primary',p:message.messageType==='image'?0:1.5,borderRadius:2,boxShadow:1,overflow:'hidden'},children:message.messageType==='text'?/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:message.content}):message.messageType==='image'?/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{position:'relative',width:'100%',maxWidth:isMobile?'250px':'300px',borderRadius:'8px 8px 0 0',overflow:'hidden',cursor:'pointer',transition:'transform 0.2s ease-in-out','&:hover':{transform:'scale(1.02)'}},onClick:()=>handleImageClick(message.fileUrl,message.content),children:[/*#__PURE__*/_jsx(\"img\",{src:getFileUrl(message.fileUrl),alt:\"\",style:{width:'100%',height:'auto',display:'block',objectFit:'cover'}}),/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',top:0,left:0,right:0,bottom:0,background:'rgba(0,0,0,0.1)',opacity:0,transition:'opacity 0.2s ease-in-out','&:hover':{opacity:1}}})]}),message.content&&/*#__PURE__*/_jsx(Box,{sx:{p:1.5,pt:1},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:message.content})})]}):message.messageType==='video'?/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(\"video\",{controls:true,style:{maxWidth:'100%',maxHeight:isMobile?'150px':'200px',borderRadius:'8px',display:'block'},children:[/*#__PURE__*/_jsx(\"source\",{src:getFileUrl(message.fileUrl),type:\"video/mp4\"}),\"Your browser does not support the video tag.\"]}),message.content&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mt:1},children:message.content}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mt:1},children:[getFileIcon(message.messageType),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{ml:0.5},children:message.fileName})]})]}):message.messageType==='audio'?/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(\"audio\",{controls:true,style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"source\",{src:getFileUrl(message.fileUrl),type:\"audio/mpeg\"}),\"Your browser does not support the audio tag.\"]}),message.content&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mt:1},children:message.content}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mt:1},children:[getFileIcon(message.messageType),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{ml:0.5},children:message.fileName})]})]}):/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:1},children:[getFileIcon(message.messageType),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{ml:0.5},children:message.fileName})]}),message.content&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:message.content})]})}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{mt:0.5,opacity:0.7,alignSelf:isOwnMessage?'flex-end':'flex-start'},children:new Date(message.createdAt).toLocaleTimeString()})]})},message._id);};const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[messages]);// Mobile layout\nif(isMobile){return/*#__PURE__*/_jsxs(Box,{sx:{height:'calc(100vh - 64px)',display:'flex',flexDirection:'column'},children:[selectedChat?/*#__PURE__*/// Chat view\n_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",color:\"default\",elevation:1,children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(IconButton,{edge:\"start\",onClick:()=>setSelectedChat(null),sx:{mr:2},children:/*#__PURE__*/_jsx(ArrowBackIcon,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{flexGrow:1},children:selectedChat.name}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowParticipants(true),children:/*#__PURE__*/_jsx(PeopleIcon,{})})]})}),/*#__PURE__*/_jsxs(Box,{sx:{flexGrow:1,overflow:'auto',bgcolor:'#f5f5f5'},children:[messages.map(renderMessage),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(Box,{sx:{p:1,bgcolor:'background.paper',borderTop:1,borderColor:'divider'},children:[selectedFile&&/*#__PURE__*/_jsx(Box,{sx:{mb:1,p:1,bgcolor:'grey.100',borderRadius:1},children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[getFileIcon(selectedFile.type.startsWith('image/')?'image':selectedFile.type.startsWith('video/')?'video':'audio'),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{ml:1},children:selectedFile.name})]}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:removeSelectedFile,children:/*#__PURE__*/_jsx(CloseIcon,{})})]})}),/*#__PURE__*/_jsx(Box,{component:\"form\",onSubmit:handleSendMessage,children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1,alignItems:'flex-end'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleFileSelect,accept:\"image/*,video/*,audio/*\",style:{display:'none'}}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},color:\"primary\",children:/*#__PURE__*/_jsx(AttachFileIcon,{})}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"Type a message...\",multiline:true,maxRows:3,size:\"small\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",disabled:!newMessage.trim()&&!selectedFile,sx:{minWidth:'auto',px:2},children:/*#__PURE__*/_jsx(SendIcon,{})})]})})]})]}):/*#__PURE__*/// Chat list view\n_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{sx:{p:2,bgcolor:'background.paper',borderBottom:1,borderColor:'divider'},children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"New Chat Name\",value:newChatName,onChange:e=>setNewChatName(e.target.value),size:\"small\",sx:{mb:1}}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",onClick:handleCreateChat,disabled:!newChatName.trim(),children:\"Create Chat\"})]}),/*#__PURE__*/_jsx(Box,{sx:{flexGrow:1,overflow:'auto'},children:/*#__PURE__*/_jsx(List,{children:chats.map(chat=>{var _chat$participants;return/*#__PURE__*/_jsx(ListItem,{button:true,selected:(selectedChat===null||selectedChat===void 0?void 0:selectedChat._id)===chat._id,onClick:()=>setSelectedChat(chat),sx:{borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsx(ListItemText,{primary:chat.name,secondary:\"\".concat(((_chat$participants=chat.participants)===null||_chat$participants===void 0?void 0:_chat$participants.length)||0,\" participants\")})},chat._id);})})})]}),/*#__PURE__*/_jsxs(Dialog,{open:showParticipants,onClose:()=>setShowParticipants(false),fullScreen:isMobile,children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[isMobile&&/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowParticipants(false),sx:{position:'absolute',right:8,top:8},children:/*#__PURE__*/_jsx(CloseIcon,{})}),\"Chat Participants\"]}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(List,{children:participants.map(participant=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:participant.username.charAt(0).toUpperCase()})}),/*#__PURE__*/_jsx(ListItemText,{primary:participant.username,secondary:participant.email})]},participant._id))})})]}),/*#__PURE__*/_jsx(Dialog,{open:showImageModal,onClose:closeImageModal,fullScreen:isMobile,PaperProps:{sx:{bgcolor:'rgba(0,0,0,0.9)',boxShadow:'none',borderRadius:0,m:0,height:'100vh',width:'100vw'}},children:/*#__PURE__*/_jsxs(Box,{sx:{position:'relative',height:'100vh',display:'flex',flexDirection:'column',justifyContent:'center',alignItems:'center'},children:[/*#__PURE__*/_jsx(IconButton,{onClick:closeImageModal,sx:{position:'absolute',top:16,right:16,color:'white',bgcolor:'rgba(0,0,0,0.5)','&:hover':{bgcolor:'rgba(0,0,0,0.7)'}},children:/*#__PURE__*/_jsx(CloseIcon,{})}),selectedImage&&/*#__PURE__*/_jsx(\"img\",{src:getFileUrl(selectedImage.url),alt:\"\",style:{maxWidth:'100%',maxHeight:'80vh',objectFit:'contain'}}),(selectedImage===null||selectedImage===void 0?void 0:selectedImage.caption)&&/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',bottom:0,left:0,right:0,bgcolor:'rgba(0,0,0,0.7)',color:'white',p:2,textAlign:'center'},children:/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:selectedImage.caption})})]})})]});}// Desktop layout\nreturn/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{mt:4,height:'calc(100vh - 100px)'},children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{height:'100%'},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsxs(Paper,{sx:{p:2,height:'100%'},children:[/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"New Chat Name\",value:newChatName,onChange:e=>setNewChatName(e.target.value),sx:{mb:1}}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",onClick:handleCreateChat,disabled:!newChatName.trim(),children:\"Create Chat\"})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsx(List,{children:chats.map(chat=>{var _chat$participants2;return/*#__PURE__*/_jsx(ListItem,{button:true,selected:(selectedChat===null||selectedChat===void 0?void 0:selectedChat._id)===chat._id,onClick:()=>setSelectedChat(chat),children:/*#__PURE__*/_jsx(ListItemText,{primary:chat.name,secondary:\"\".concat(((_chat$participants2=chat.participants)===null||_chat$participants2===void 0?void 0:_chat$participants2.length)||0,\" participants\")})},chat._id);})})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:8,children:/*#__PURE__*/_jsx(Paper,{sx:{p:2,height:'100%',display:'flex',flexDirection:'column'},children:selectedChat?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{flexGrow:1},children:selectedChat.name}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowParticipants(true),children:/*#__PURE__*/_jsx(PeopleIcon,{})})]}),/*#__PURE__*/_jsxs(Box,{sx:{flexGrow:1,overflow:'auto',mb:2},children:[messages.map(renderMessage),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),selectedFile&&/*#__PURE__*/_jsx(Box,{sx:{mb:2,p:1,bgcolor:'grey.100',borderRadius:1},children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center'},children:[getFileIcon(selectedFile.type.startsWith('image/')?'image':selectedFile.type.startsWith('video/')?'video':'audio'),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{ml:1},children:selectedFile.name})]}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:removeSelectedFile,children:/*#__PURE__*/_jsx(CloseIcon,{})})]})}),/*#__PURE__*/_jsx(Box,{component:\"form\",onSubmit:handleSendMessage,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,children:[/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleFileSelect,accept:\"image/*,video/*,audio/*\",style:{display:'none'}}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>{var _fileInputRef$current2;return(_fileInputRef$current2=fileInputRef.current)===null||_fileInputRef$current2===void 0?void 0:_fileInputRef$current2.click();},color:\"primary\",children:/*#__PURE__*/_jsx(AttachFileIcon,{})})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:true,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"Type a message...\",multiline:true,maxRows:3})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",endIcon:/*#__PURE__*/_jsx(SendIcon,{}),disabled:!newMessage.trim()&&!selectedFile,children:\"Send\"})})]})})]}):/*#__PURE__*/_jsx(Box,{sx:{display:'flex',alignItems:'center',justifyContent:'center',height:'100%'},children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"Select a chat to start messaging\"})})})})]}),/*#__PURE__*/_jsxs(Dialog,{open:showParticipants,onClose:()=>setShowParticipants(false),children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Chat Participants\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(List,{children:participants.map(participant=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:participant.username.charAt(0).toUpperCase()})}),/*#__PURE__*/_jsx(ListItemText,{primary:participant.username,secondary:participant.email})]},participant._id))})})]}),/*#__PURE__*/_jsx(Dialog,{open:showImageModal,onClose:closeImageModal,maxWidth:false,PaperProps:{sx:{bgcolor:'rgba(0,0,0,0.9)',boxShadow:'none',borderRadius:0,m:0,height:'100vh',width:'100vw'}},children:/*#__PURE__*/_jsxs(Box,{sx:{position:'relative',height:'100vh',display:'flex',flexDirection:'column',justifyContent:'center',alignItems:'center'},children:[/*#__PURE__*/_jsx(IconButton,{onClick:closeImageModal,sx:{position:'absolute',top:16,right:16,color:'white',bgcolor:'rgba(0,0,0,0.5)','&:hover':{bgcolor:'rgba(0,0,0,0.7)'}},children:/*#__PURE__*/_jsx(CloseIcon,{})}),selectedImage&&/*#__PURE__*/_jsx(\"img\",{src:getFileUrl(selectedImage.url),alt:\"\",style:{maxWidth:'100%',maxHeight:'80vh',objectFit:'contain'}}),(selectedImage===null||selectedImage===void 0?void 0:selectedImage.caption)&&/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',bottom:0,left:0,right:0,bgcolor:'rgba(0,0,0,0.7)',color:'white',p:2,textAlign:'center'},children:/*#__PURE__*/_jsx(Typography,{variant:\"body1\",children:selectedImage.caption})})]})})]});};export default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","Container","Grid","Paper","Typography","Box","TextField","Button","List","ListItem","ListItemText","Divider","IconButton","Avatar","Dialog","DialogTitle","DialogContent","ListItemAvatar","useMediaQuery","useTheme","AppBar","Toolbar","Send","SendIcon","AttachFile","AttachFileIcon","Image","ImageIcon","Videocam","VideoIcon","Mic","MicIcon","People","PeopleIcon","Close","CloseIcon","ArrowBack","ArrowBackIcon","axios","useAuth","getFileUrl","io","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Chat","user","theme","isMobile","breakpoints","down","chats","setChats","selectedChat","setSelectedChat","messages","setMessages","newMessage","setNewMessage","newChatName","setNewChatName","participants","setParticipants","showParticipants","setShowParticipants","selectedFile","setSelectedFile","fileInputRef","selectedImage","setSelectedImage","showImageModal","setShowImageModal","messagesEndRef","socketRef","fetchChats","SOCKET_URL","process","env","REACT_APP_API_URL","current","disconnect","fetchMessages","_id","fetchParticipants","emit","on","message","prev","res","get","data","error","console","chatId","concat","handleCreateChat","post","name","handleSendMessage","e","preventDefault","trim","formData","FormData","append","headers","content","handleFileSelect","event","file","target","files","removeSelectedFile","value","handleImageClick","imageUrl","caption","url","closeImageModal","getFileIcon","messageType","renderMessage","isOwnMessage","sender","sx","display","justifyContent","mb","px","children","maxWidth","flexDirection","variant","fontWeight","color","username","bgcolor","p","borderRadius","boxShadow","overflow","position","width","cursor","transition","transform","onClick","fileUrl","src","alt","style","height","objectFit","top","left","right","bottom","background","opacity","pt","controls","maxHeight","type","mt","alignItems","ml","fileName","alignSelf","Date","createdAt","toLocaleTimeString","scrollToBottom","_messagesEndRef$curre","scrollIntoView","behavior","elevation","edge","mr","flexGrow","map","ref","borderTop","borderColor","startsWith","size","component","onSubmit","gap","onChange","accept","_fileInputRef$current","click","fullWidth","placeholder","multiline","maxRows","disabled","minWidth","borderBottom","label","chat","_chat$participants","button","selected","primary","secondary","length","open","onClose","fullScreen","participant","charAt","toUpperCase","email","PaperProps","m","textAlign","container","spacing","item","xs","md","my","_chat$participants2","_fileInputRef$current2","endIcon"],"sources":["/Users/lukasygina/Desktop/CC201/labs/chat-app-only/client/src/pages/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Container,\n  Grid,\n  Paper,\n  Typography,\n  Box,\n  TextField,\n  Button,\n  List,\n  ListItem,\n  ListItemText,\n  Divider,\n  IconButton,\n  Avatar,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  ListItemAvatar,\n  useMediaQuery,\n  useTheme,\n  AppBar,\n  Toolbar\n} from '@mui/material';\nimport {\n  Send as SendIcon,\n  AttachFile as AttachFileIcon,\n  Image as ImageIcon,\n  Videocam as VideoIcon,\n  Mic as MicIcon,\n  People as PeopleIcon,\n  Close as CloseIcon,\n  ArrowBack as ArrowBackIcon\n} from '@mui/icons-material';\nimport axios from 'axios';\nimport { useAuth } from '../context/AuthContext';\nimport { getFileUrl } from '../utils/api';\nimport io from 'socket.io-client';\n\nconst Chat = () => {\n  const { user } = useAuth();\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\n  \n  const [chats, setChats] = useState([]);\n  const [selectedChat, setSelectedChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [newChatName, setNewChatName] = useState('');\n  const [participants, setParticipants] = useState([]);\n  const [showParticipants, setShowParticipants] = useState(false);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [fileInputRef] = useState(useRef());\n  const [selectedImage, setSelectedImage] = useState(null);\n  const [showImageModal, setShowImageModal] = useState(false);\n  const messagesEndRef = useRef();\n  const socketRef = useRef();\n\n  useEffect(() => {\n    fetchChats();\n    const SOCKET_URL = process.env.REACT_APP_API_URL || 'https://chat-app-backend-6e9b.onrender.com';\n    socketRef.current = io(SOCKET_URL);\n\n    return () => {\n      socketRef.current.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (selectedChat) {\n      fetchMessages(selectedChat._id);\n      fetchParticipants(selectedChat._id);\n      socketRef.current.emit('join', selectedChat._id);\n    }\n\n    return () => {\n      if (selectedChat) {\n        socketRef.current.emit('leave', selectedChat._id);\n      }\n    };\n  }, [selectedChat, isMobile]);\n\n  useEffect(() => {\n    socketRef.current.on('message', (message) => {\n      setMessages((prev) => [...prev, message]);\n    });\n  }, []);\n\n  const fetchChats = async () => {\n    try {\n      const res = await axios.get('/api/chats');\n      setChats(res.data);\n    } catch (error) {\n      console.error('Error fetching chats:', error);\n    }\n  };\n\n  const fetchMessages = async (chatId) => {\n    try {\n      const res = await axios.get(`/api/chats/${chatId}`);\n      setMessages(res.data.messages);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n\n  const fetchParticipants = async (chatId) => {\n    try {\n      const res = await axios.get(`/api/chats/${chatId}/participants`);\n      setParticipants(res.data);\n    } catch (error) {\n      console.error('Error fetching participants:', error);\n    }\n  };\n\n  const handleCreateChat = async () => {\n    try {\n      await axios.post('/api/chats', { name: newChatName });\n      setNewChatName('');\n      fetchChats();\n    } catch (error) {\n      console.error('Error creating chat:', error);\n    }\n  };\n\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    if (!newMessage.trim() && !selectedFile) return;\n\n    try {\n      let res;\n      if (selectedFile) {\n        // Send media message\n        const formData = new FormData();\n        formData.append('file', selectedFile);\n        if (newMessage.trim()) {\n          formData.append('caption', newMessage);\n        }\n\n        res = await axios.post(`/api/chats/${selectedChat._id}/media`, formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        setMessages((prev) => [...prev, res.data]);\n        setSelectedFile(null);\n        setNewMessage('');\n      } else {\n        // Send text message\n        res = await axios.post(`/api/chats/${selectedChat._id}/messages`, {\n          content: newMessage\n        });\n        setMessages((prev) => [...prev, res.data]);\n        setNewMessage('');\n      }\n\n      socketRef.current.emit('message', {\n        chatId: selectedChat._id,\n        message: res.data\n      });\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const handleFileSelect = (event) => {\n    const file = event.target.files[0];\n    if (file) {\n      setSelectedFile(file);\n    }\n  };\n\n  const removeSelectedFile = () => {\n    setSelectedFile(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const handleImageClick = (imageUrl, caption) => {\n    setSelectedImage({ url: imageUrl, caption });\n    setShowImageModal(true);\n  };\n\n  const closeImageModal = () => {\n    setShowImageModal(false);\n    setSelectedImage(null);\n  };\n\n  const getFileIcon = (messageType) => {\n    switch (messageType) {\n      case 'image':\n        return <ImageIcon />;\n      case 'video':\n        return <VideoIcon />;\n      case 'audio':\n        return <MicIcon />;\n      default:\n        return <AttachFileIcon />;\n    }\n  };\n\n  const renderMessage = (message) => {\n    const isOwnMessage = message.sender._id === user._id;\n    \n    return (\n      <Box\n        key={message._id}\n        sx={{\n          display: 'flex',\n          justifyContent: isOwnMessage ? 'flex-end' : 'flex-start',\n          mb: 2,\n          px: isMobile ? 1 : 2\n        }}\n      >\n        <Box\n          sx={{\n            maxWidth: isMobile ? '85%' : '70%',\n            display: 'flex',\n            flexDirection: 'column'\n          }}\n        >\n          {/* Sender name */}\n          <Typography \n            variant=\"caption\" \n            sx={{ \n              mb: 0.5,\n              fontWeight: 'bold',\n              color: isOwnMessage ? 'primary.main' : 'text.secondary'\n            }}\n          >\n            {isOwnMessage ? 'TÃº' : message.sender.username}\n          </Typography>\n          \n          {/* Message content */}\n          <Box\n            sx={{\n              bgcolor: isOwnMessage ? 'primary.main' : 'grey.200',\n              color: isOwnMessage ? 'white' : 'text.primary',\n              p: message.messageType === 'image' ? 0 : 1.5,\n              borderRadius: 2,\n              boxShadow: 1,\n              overflow: 'hidden'\n            }}\n          >\n            {message.messageType === 'text' ? (\n              <Typography variant=\"body1\">\n                {message.content}\n              </Typography>\n            ) : message.messageType === 'image' ? (\n              <Box>\n                {/* WhatsApp-style image container */}\n                <Box\n                  sx={{\n                    position: 'relative',\n                    width: '100%',\n                    maxWidth: isMobile ? '250px' : '300px',\n                    borderRadius: '8px 8px 0 0',\n                    overflow: 'hidden',\n                    cursor: 'pointer',\n                    transition: 'transform 0.2s ease-in-out',\n                    '&:hover': {\n                      transform: 'scale(1.02)'\n                    }\n                  }}\n                  onClick={() => handleImageClick(message.fileUrl, message.content)}\n                >\n                  <img \n                    src={getFileUrl(message.fileUrl)} \n                    alt=\"\"\n                    style={{ \n                      width: '100%',\n                      height: 'auto',\n                      display: 'block',\n                      objectFit: 'cover'\n                    }} \n                  />\n                  {/* WhatsApp-style image overlay on hover */}\n                  <Box\n                    sx={{\n                      position: 'absolute',\n                      top: 0,\n                      left: 0,\n                      right: 0,\n                      bottom: 0,\n                      background: 'rgba(0,0,0,0.1)',\n                      opacity: 0,\n                      transition: 'opacity 0.2s ease-in-out',\n                      '&:hover': {\n                        opacity: 1\n                      }\n                    }}\n                  />\n                </Box>\n                \n                {/* Caption below image (like WhatsApp) */}\n                {message.content && (\n                  <Box sx={{ p: 1.5, pt: 1 }}>\n                    <Typography variant=\"body2\">\n                      {message.content}\n                    </Typography>\n                  </Box>\n                )}\n              </Box>\n            ) : message.messageType === 'video' ? (\n              <Box>\n                <video \n                  controls \n                  style={{ \n                    maxWidth: '100%', \n                    maxHeight: isMobile ? '150px' : '200px', \n                    borderRadius: '8px',\n                    display: 'block'\n                  }}\n                >\n                  <source src={getFileUrl(message.fileUrl)} type=\"video/mp4\" />\n                  Your browser does not support the video tag.\n                </video>\n                {message.content && (\n                  <Typography variant=\"body2\" sx={{ mt: 1 }}>\n                    {message.content}\n                  </Typography>\n                )}\n                <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                  {getFileIcon(message.messageType)}\n                  <Typography variant=\"caption\" sx={{ ml: 0.5 }}>\n                    {message.fileName}\n                  </Typography>\n                </Box>\n              </Box>\n            ) : message.messageType === 'audio' ? (\n              <Box>\n                <audio controls style={{ width: '100%' }}>\n                  <source src={getFileUrl(message.fileUrl)} type=\"audio/mpeg\" />\n                  Your browser does not support the audio tag.\n                </audio>\n                {message.content && (\n                  <Typography variant=\"body2\" sx={{ mt: 1 }}>\n                    {message.content}\n                  </Typography>\n                )}\n                <Box sx={{ display: 'flex', alignItems: 'center', mt: 1 }}>\n                  {getFileIcon(message.messageType)}\n                  <Typography variant=\"caption\" sx={{ ml: 0.5 }}>\n                    {message.fileName}\n                  </Typography>\n                </Box>\n              </Box>\n            ) : (\n              <Box>\n                <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                  {getFileIcon(message.messageType)}\n                  <Typography variant=\"body2\" sx={{ ml: 0.5 }}>\n                    {message.fileName}\n                  </Typography>\n                </Box>\n                {message.content && (\n                  <Typography variant=\"body2\">\n                    {message.content}\n                  </Typography>\n                )}\n              </Box>\n            )}\n          </Box>\n          \n          {/* Message time */}\n          <Typography \n            variant=\"caption\" \n            sx={{ \n              mt: 0.5,\n              opacity: 0.7,\n              alignSelf: isOwnMessage ? 'flex-end' : 'flex-start'\n            }}\n          >\n            {new Date(message.createdAt).toLocaleTimeString()}\n          </Typography>\n        </Box>\n      </Box>\n    );\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Mobile layout\n  if (isMobile) {\n    return (\n      <Box sx={{ height: 'calc(100vh - 64px)', display: 'flex', flexDirection: 'column' }}>\n        {selectedChat ? (\n          // Chat view\n          <>\n            {/* Chat header */}\n            <AppBar position=\"static\" color=\"default\" elevation={1}>\n              <Toolbar>\n                <IconButton\n                  edge=\"start\"\n                  onClick={() => setSelectedChat(null)}\n                  sx={{ mr: 2 }}\n                >\n                  <ArrowBackIcon />\n                </IconButton>\n                <Typography variant=\"h6\" sx={{ flexGrow: 1 }}>\n                  {selectedChat.name}\n                </Typography>\n                <IconButton onClick={() => setShowParticipants(true)}>\n                  <PeopleIcon />\n                </IconButton>\n              </Toolbar>\n            </AppBar>\n\n            {/* Messages area */}\n            <Box sx={{ flexGrow: 1, overflow: 'auto', bgcolor: '#f5f5f5' }}>\n              {messages.map(renderMessage)}\n              <div ref={messagesEndRef} />\n            </Box>\n\n            {/* Message input */}\n            <Box sx={{ p: 1, bgcolor: 'background.paper', borderTop: 1, borderColor: 'divider' }}>\n              {/* Selected file preview */}\n              {selectedFile && (\n                <Box sx={{ mb: 1, p: 1, bgcolor: 'grey.100', borderRadius: 1 }}>\n                  <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                      {getFileIcon(selectedFile.type.startsWith('image/') ? 'image' : \n                                  selectedFile.type.startsWith('video/') ? 'video' : 'audio')}\n                      <Typography variant=\"body2\" sx={{ ml: 1 }}>\n                        {selectedFile.name}\n                      </Typography>\n                    </Box>\n                    <IconButton size=\"small\" onClick={removeSelectedFile}>\n                      <CloseIcon />\n                    </IconButton>\n                  </Box>\n                </Box>\n              )}\n\n              <Box component=\"form\" onSubmit={handleSendMessage}>\n                <Box sx={{ display: 'flex', gap: 1, alignItems: 'flex-end' }}>\n                  <input\n                    type=\"file\"\n                    ref={fileInputRef}\n                    onChange={handleFileSelect}\n                    accept=\"image/*,video/*,audio/*\"\n                    style={{ display: 'none' }}\n                  />\n                  <IconButton \n                    onClick={() => fileInputRef.current?.click()}\n                    color=\"primary\"\n                  >\n                    <AttachFileIcon />\n                  </IconButton>\n                  <TextField\n                    fullWidth\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    placeholder=\"Type a message...\"\n                    multiline\n                    maxRows={3}\n                    size=\"small\"\n                  />\n                  <Button\n                    type=\"submit\"\n                    variant=\"contained\"\n                    disabled={!newMessage.trim() && !selectedFile}\n                    sx={{ minWidth: 'auto', px: 2 }}\n                  >\n                    <SendIcon />\n                  </Button>\n                </Box>\n              </Box>\n            </Box>\n          </>\n        ) : (\n          // Chat list view\n          <>\n            <Box sx={{ p: 2, bgcolor: 'background.paper', borderBottom: 1, borderColor: 'divider' }}>\n              <TextField\n                fullWidth\n                label=\"New Chat Name\"\n                value={newChatName}\n                onChange={(e) => setNewChatName(e.target.value)}\n                size=\"small\"\n                sx={{ mb: 1 }}\n              />\n              <Button\n                fullWidth\n                variant=\"contained\"\n                onClick={handleCreateChat}\n                disabled={!newChatName.trim()}\n              >\n                Create Chat\n              </Button>\n            </Box>\n            \n            <Box sx={{ flexGrow: 1, overflow: 'auto' }}>\n              <List>\n                {chats.map((chat) => (\n                  <ListItem\n                    key={chat._id}\n                    button\n                    selected={selectedChat?._id === chat._id}\n                    onClick={() => setSelectedChat(chat)}\n                    sx={{ borderBottom: 1, borderColor: 'divider' }}\n                  >\n                    <ListItemText \n                      primary={chat.name}\n                      secondary={`${chat.participants?.length || 0} participants`}\n                    />\n                  </ListItem>\n                ))}\n              </List>\n            </Box>\n          </>\n        )}\n\n        {/* Participants Dialog */}\n        <Dialog \n          open={showParticipants} \n          onClose={() => setShowParticipants(false)}\n          fullScreen={isMobile}\n        >\n          <DialogTitle>\n            {isMobile && (\n              <IconButton\n                onClick={() => setShowParticipants(false)}\n                sx={{ position: 'absolute', right: 8, top: 8 }}\n              >\n                <CloseIcon />\n              </IconButton>\n            )}\n            Chat Participants\n          </DialogTitle>\n          <DialogContent>\n            <List>\n              {participants.map((participant) => (\n                <ListItem key={participant._id}>\n                  <ListItemAvatar>\n                    <Avatar>{participant.username.charAt(0).toUpperCase()}</Avatar>\n                  </ListItemAvatar>\n                  <ListItemText \n                    primary={participant.username}\n                    secondary={participant.email}\n                  />\n                </ListItem>\n              ))}\n            </List>\n          </DialogContent>\n        </Dialog>\n\n        {/* Full-screen Image Modal */}\n        <Dialog \n          open={showImageModal} \n          onClose={closeImageModal}\n          fullScreen={isMobile}\n          PaperProps={{\n            sx: {\n              bgcolor: 'rgba(0,0,0,0.9)',\n              boxShadow: 'none',\n              borderRadius: 0,\n              m: 0,\n              height: '100vh',\n              width: '100vw'\n            }\n          }}\n        >\n          <Box\n            sx={{\n              position: 'relative',\n              height: '100vh',\n              display: 'flex',\n              flexDirection: 'column',\n              justifyContent: 'center',\n              alignItems: 'center'\n            }}\n          >\n            {/* Close button */}\n            <IconButton\n              onClick={closeImageModal}\n              sx={{\n                position: 'absolute',\n                top: 16,\n                right: 16,\n                color: 'white',\n                bgcolor: 'rgba(0,0,0,0.5)',\n                '&:hover': {\n                  bgcolor: 'rgba(0,0,0,0.7)'\n                }\n              }}\n            >\n              <CloseIcon />\n            </IconButton>\n\n            {/* Image */}\n            {selectedImage && (\n              <img\n                src={getFileUrl(selectedImage.url)}\n                alt=\"\"\n                style={{\n                  maxWidth: '100%',\n                  maxHeight: '80vh',\n                  objectFit: 'contain'\n                }}\n              />\n            )}\n\n            {/* Caption */}\n            {selectedImage?.caption && (\n              <Box\n                sx={{\n                  position: 'absolute',\n                  bottom: 0,\n                  left: 0,\n                  right: 0,\n                  bgcolor: 'rgba(0,0,0,0.7)',\n                  color: 'white',\n                  p: 2,\n                  textAlign: 'center'\n                }}\n              >\n                <Typography variant=\"body1\">\n                  {selectedImage.caption}\n                </Typography>\n              </Box>\n            )}\n          </Box>\n        </Dialog>\n      </Box>\n    );\n  }\n\n  // Desktop layout\n  return (\n    <Container maxWidth=\"lg\" sx={{ mt: 4, height: 'calc(100vh - 100px)' }}>\n      <Grid container spacing={2} sx={{ height: '100%' }}>\n        <Grid item xs={12} md={4}>\n          <Paper sx={{ p: 2, height: '100%' }}>\n            <Box sx={{ mb: 2 }}>\n              <TextField\n                fullWidth\n                label=\"New Chat Name\"\n                value={newChatName}\n                onChange={(e) => setNewChatName(e.target.value)}\n                sx={{ mb: 1 }}\n              />\n              <Button\n                fullWidth\n                variant=\"contained\"\n                onClick={handleCreateChat}\n                disabled={!newChatName.trim()}\n              >\n                Create Chat\n              </Button>\n            </Box>\n            <Divider sx={{ my: 2 }} />\n            <List>\n              {chats.map((chat) => (\n                <ListItem\n                  key={chat._id}\n                  button\n                  selected={selectedChat?._id === chat._id}\n                  onClick={() => setSelectedChat(chat)}\n                >\n                  <ListItemText \n                    primary={chat.name}\n                    secondary={`${chat.participants?.length || 0} participants`}\n                  />\n                </ListItem>\n              ))}\n            </List>\n          </Paper>\n        </Grid>\n        <Grid item xs={12} md={8}>\n          <Paper sx={{ p: 2, height: '100%', display: 'flex', flexDirection: 'column' }}>\n            {selectedChat ? (\n              <>\n                <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n                  <Typography variant=\"h6\" sx={{ flexGrow: 1 }}>\n                    {selectedChat.name}\n                  </Typography>\n                  <IconButton onClick={() => setShowParticipants(true)}>\n                    <PeopleIcon />\n                  </IconButton>\n                </Box>\n                \n                <Box sx={{ flexGrow: 1, overflow: 'auto', mb: 2 }}>\n                  {messages.map(renderMessage)}\n                  <div ref={messagesEndRef} />\n                </Box>\n\n                {/* Selected file preview */}\n                {selectedFile && (\n                  <Box sx={{ mb: 2, p: 1, bgcolor: 'grey.100', borderRadius: 1 }}>\n                    <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n                      <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                        {getFileIcon(selectedFile.type.startsWith('image/') ? 'image' : \n                                    selectedFile.type.startsWith('video/') ? 'video' : 'audio')}\n                        <Typography variant=\"body2\" sx={{ ml: 1 }}>\n                          {selectedFile.name}\n                        </Typography>\n                      </Box>\n                      <IconButton size=\"small\" onClick={removeSelectedFile}>\n                        <CloseIcon />\n                      </IconButton>\n                    </Box>\n                  </Box>\n                )}\n\n                <Box component=\"form\" onSubmit={handleSendMessage}>\n                  <Grid container spacing={1}>\n                    <Grid item>\n                      <input\n                        type=\"file\"\n                        ref={fileInputRef}\n                        onChange={handleFileSelect}\n                        accept=\"image/*,video/*,audio/*\"\n                        style={{ display: 'none' }}\n                      />\n                      <IconButton \n                        onClick={() => fileInputRef.current?.click()}\n                        color=\"primary\"\n                      >\n                        <AttachFileIcon />\n                      </IconButton>\n                    </Grid>\n                    <Grid item xs>\n                      <TextField\n                        fullWidth\n                        value={newMessage}\n                        onChange={(e) => setNewMessage(e.target.value)}\n                        placeholder=\"Type a message...\"\n                        multiline\n                        maxRows={3}\n                      />\n                    </Grid>\n                    <Grid item>\n                      <Button\n                        type=\"submit\"\n                        variant=\"contained\"\n                        endIcon={<SendIcon />}\n                        disabled={!newMessage.trim() && !selectedFile}\n                      >\n                        Send\n                      </Button>\n                    </Grid>\n                  </Grid>\n                </Box>\n              </>\n            ) : (\n              <Box\n                sx={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  height: '100%'\n                }}\n              >\n                <Typography variant=\"h6\" color=\"text.secondary\">\n                  Select a chat to start messaging\n                </Typography>\n              </Box>\n            )}\n          </Paper>\n        </Grid>\n      </Grid>\n\n      {/* Participants Dialog */}\n      <Dialog open={showParticipants} onClose={() => setShowParticipants(false)}>\n        <DialogTitle>Chat Participants</DialogTitle>\n        <DialogContent>\n          <List>\n            {participants.map((participant) => (\n              <ListItem key={participant._id}>\n                <ListItemAvatar>\n                  <Avatar>{participant.username.charAt(0).toUpperCase()}</Avatar>\n                </ListItemAvatar>\n                <ListItemText \n                  primary={participant.username}\n                  secondary={participant.email}\n                />\n              </ListItem>\n            ))}\n          </List>\n        </DialogContent>\n      </Dialog>\n\n      {/* Full-screen Image Modal */}\n      <Dialog \n        open={showImageModal} \n        onClose={closeImageModal}\n        maxWidth={false}\n        PaperProps={{\n          sx: {\n            bgcolor: 'rgba(0,0,0,0.9)',\n            boxShadow: 'none',\n            borderRadius: 0,\n            m: 0,\n            height: '100vh',\n            width: '100vw'\n          }\n        }}\n      >\n        <Box\n          sx={{\n            position: 'relative',\n            height: '100vh',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center'\n          }}\n        >\n          {/* Close button */}\n          <IconButton\n            onClick={closeImageModal}\n            sx={{\n              position: 'absolute',\n              top: 16,\n              right: 16,\n              color: 'white',\n              bgcolor: 'rgba(0,0,0,0.5)',\n              '&:hover': {\n                bgcolor: 'rgba(0,0,0,0.7)'\n              }\n            }}\n          >\n            <CloseIcon />\n          </IconButton>\n\n          {/* Image */}\n          {selectedImage && (\n            <img\n              src={getFileUrl(selectedImage.url)}\n              alt=\"\"\n              style={{\n                maxWidth: '100%',\n                maxHeight: '80vh',\n                objectFit: 'contain'\n              }}\n            />\n          )}\n\n          {/* Caption */}\n          {selectedImage?.caption && (\n            <Box\n              sx={{\n                position: 'absolute',\n                bottom: 0,\n                left: 0,\n                right: 0,\n                bgcolor: 'rgba(0,0,0,0.7)',\n                color: 'white',\n                p: 2,\n                textAlign: 'center'\n              }}\n            >\n              <Typography variant=\"body1\">\n                {selectedImage.caption}\n              </Typography>\n            </Box>\n          )}\n        </Box>\n      </Dialog>\n    </Container>\n  );\n};\n\nexport default Chat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}