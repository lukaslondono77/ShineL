{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{Container,Grid,Paper,Typography,Box,TextField,Button,List,ListItem,ListItemText,Divider,IconButton,Avatar,Dialog,DialogTitle,DialogContent,ListItemAvatar,useMediaQuery,useTheme,AppBar,Toolbar,ToggleButton,ToggleButtonGroup}from'@mui/material';import{Send as SendIcon,People as PeopleIcon,Close as CloseIcon,ArrowBack as ArrowBackIcon,Mic as MicIcon,Keyboard as KeyboardIcon}from'@mui/icons-material';import axios from'axios';import{useAuth}from'../context/AuthContext';import io from'socket.io-client';import PWAInstallPrompt from'../components/PWAInstallPrompt';import AudioRecorder from'../components/AudioRecorder';import AudioMessage from'../components/AudioMessage';import API_URL from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Chat=()=>{var _socketRef$current2,_selectedChat$partici2;const{user}=useAuth();const theme=useTheme();const isMobile=useMediaQuery(theme.breakpoints.down('md'));const[chats,setChats]=useState([]);const[selectedChat,setSelectedChat]=useState(null);const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[showParticipants,setShowParticipants]=useState(false);const[inputMode,setInputMode]=useState('text');// 'text' or 'audio'\nconst messagesEndRef=useRef();const socketRef=useRef();const messageListenerRegistered=useRef(false);useEffect(()=>{fetchChats();const SOCKET_URL=process.env.REACT_APP_API_URL||'https://chat-app-backend-6e9b.onrender.com';console.log('ðŸ”„ Component mounting - Creating Socket.IO connection to:',SOCKET_URL);socketRef.current=io(SOCKET_URL);socketRef.current.on('connect',()=>{console.log('âœ… Socket.IO connected with ID:',socketRef.current.id);});socketRef.current.on('disconnect',()=>{console.log('âŒ Socket.IO disconnected');});return()=>{console.log('ðŸ”„ Component unmounting - Cleaning up Socket.IO connection');if(socketRef.current){socketRef.current.disconnect();}};},[]);useEffect(()=>{if(chats.length>0&&!selectedChat){// Automatically select the first (and only) chat (Global Chat)\nsetSelectedChat(chats[0]);}},[chats,selectedChat]);useEffect(()=>{if(selectedChat){fetchMessages(selectedChat._id);socketRef.current.emit('join',selectedChat._id);}return()=>{if(selectedChat){socketRef.current.emit('leave',selectedChat._id);}};},[selectedChat,isMobile]);useEffect(()=>{// Only register listener once when socket is available\nif(!socketRef.current||messageListenerRegistered.current){console.log('ðŸš« Skipping message listener registration:',{socketExists:!!socketRef.current,alreadyRegistered:messageListenerRegistered.current});return;}console.log('ðŸŽ¯ Registering message listener for the first time - Socket ID:',socketRef.current.id);messageListenerRegistered.current=true;socketRef.current.on('message',message=>{var _message$sender,_socketRef$current;console.log('ðŸ“¨ Received message via Socket.IO:',{id:message._id,content:message.content,audioUrl:message.audioUrl,messageType:message.messageType,sender:(_message$sender=message.sender)===null||_message$sender===void 0?void 0:_message$sender.username,timestamp:new Date().toISOString(),socketId:(_socketRef$current=socketRef.current)===null||_socketRef$current===void 0?void 0:_socketRef$current.id});if(message&&message.sender&&(message.content||message.audioUrl)){setMessages(prev=>{// Check if message already exists to prevent duplicates\nconst messageExists=prev.some(msg=>msg._id===message._id);if(messageExists){console.log('ðŸš« Message already exists, not adding duplicate:',message._id);return prev;}console.log('âœ… Adding new message to state:',message._id);return[...prev,message];});}else{console.error('âŒ Invalid message structure received:',message);}});// Cleanup function\nreturn()=>{if(socketRef.current){console.log('ðŸ§¹ Cleaning up message listener for socket:',socketRef.current.id);socketRef.current.off('message');messageListenerRegistered.current=false;}};},[(_socketRef$current2=socketRef.current)===null||_socketRef$current2===void 0?void 0:_socketRef$current2.connected]);const fetchChats=async()=>{try{const res=await axios.get('/api/chats');setChats(res.data);}catch(error){console.error('Error fetching chats:',error);}};const fetchMessages=async chatId=>{try{const res=await axios.get(\"/api/chats/\".concat(chatId));setMessages(res.data.messages);}catch(error){console.error('Error fetching messages:',error);}};const handleSendMessage=async e=>{e.preventDefault();if(!newMessage.trim())return;console.log('Sending message:',{content:newMessage,chatId:selectedChat._id,userId:user._id});try{const res=await axios.post(\"/api/chats/\".concat(selectedChat._id,\"/messages\"),{content:newMessage});console.log('Message sent successfully via HTTP:',res.data);// Don't manually add the message here - let Socket.IO handle it\n// setMessages((prev) => [...prev, res.data]);\nsetNewMessage('');// Don't emit via Socket.IO - the backend will handle this\n// socketRef.current.emit('message', {\n//   chatId: selectedChat._id,\n//   message: res.data\n// });\n}catch(error){console.error('Error sending message:',error);}};const handleSendAudio=async(audioUrl,duration)=>{try{console.log('Sending audio message:',{audioUrl,duration,chatId:selectedChat._id});const res=await axios.post(\"\".concat(API_URL,\"/api/audio/chats/\").concat(selectedChat._id,\"/audio\"),{audioUrl,audioDuration:duration});console.log('Audio message sent successfully:',res.data);}catch(error){console.error('Error sending audio message:',error);if(error.response){console.error('Error response:',error.response.data);console.error('Error status:',error.response.status);}}};const renderMessage=message=>{// Add null checks to prevent errors\nif(!message||!message.sender||!user){return null;}const isOwnMessage=message.sender._id===user._id;return/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:isOwnMessage?'flex-end':'flex-start',mb:2,px:1},children:/*#__PURE__*/_jsxs(Box,{sx:{maxWidth:isMobile?'80%':'60%',display:'flex',flexDirection:isOwnMessage?'row-reverse':'row',alignItems:'flex-end',gap:1},children:[!isOwnMessage&&/*#__PURE__*/_jsx(Avatar,{sx:{width:32,height:32,bgcolor:'primary.main',fontSize:'0.875rem'},children:message.sender.username[0].toUpperCase()}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:'column',alignItems:isOwnMessage?'flex-end':'flex-start',maxWidth:'100%'},children:[!isOwnMessage&&/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{color:'text.secondary',mb:0.5,fontSize:'0.75rem'},children:message.sender.username}),message.messageType==='audio'?/*#__PURE__*/_jsx(AudioMessage,{audioUrl:message.audioUrl,duration:message.audioDuration,isOwnMessage:isOwnMessage}):/*#__PURE__*/_jsx(Paper,{elevation:1,sx:{p:1.5,bgcolor:isOwnMessage?'primary.main':'background.paper',color:isOwnMessage?'primary.contrastText':'text.primary',borderRadius:2,border:1,borderColor:isOwnMessage?'primary.main':'divider',wordBreak:'break-word',maxWidth:'100%'},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:message.content})}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{color:'text.secondary',mt:0.5,fontSize:'0.7rem'},children:new Date(message.createdAt).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]})]})},message._id);};const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[messages]);if(isMobile){var _selectedChat$partici;return/*#__PURE__*/_jsxs(Box,{sx:{height:'100vh',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsx(AppBar,{position:\"static\",children:/*#__PURE__*/_jsxs(Toolbar,{children:[/*#__PURE__*/_jsx(IconButton,{edge:\"start\",color:\"inherit\",onClick:()=>window.history.back(),children:/*#__PURE__*/_jsx(ArrowBackIcon,{})}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{flexGrow:1},children:(selectedChat===null||selectedChat===void 0?void 0:selectedChat.name)||'Chat'}),/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",onClick:()=>setShowParticipants(true),children:/*#__PURE__*/_jsx(PeopleIcon,{})})]})}),/*#__PURE__*/_jsxs(Box,{sx:{flexGrow:1,overflowY:'auto',p:1,bgcolor:'background.default'},children:[messages.map(renderMessage),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(Box,{sx:{p:2,bgcolor:'background.paper',borderTop:1,borderColor:'divider'},children:inputMode==='text'?/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleSendMessage,sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,size:\"small\",placeholder:\"Escribe un mensaje...\",value:newMessage,onChange:e=>setNewMessage(e.target.value),sx:{flexGrow:1}}),/*#__PURE__*/_jsx(IconButton,{type:\"submit\",color:\"primary\",disabled:!newMessage.trim(),sx:{bgcolor:'primary.main',color:'white','&:hover':{bgcolor:'primary.dark'}},children:/*#__PURE__*/_jsx(SendIcon,{})}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setInputMode('audio'),color:\"primary\",children:/*#__PURE__*/_jsx(MicIcon,{})})]}):/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:'column',gap:1},children:[/*#__PURE__*/_jsx(AudioRecorder,{onSendAudio:handleSendAudio}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsx(IconButton,{onClick:()=>setInputMode('text'),color:\"primary\",children:/*#__PURE__*/_jsx(KeyboardIcon,{})})})]})}),/*#__PURE__*/_jsxs(Dialog,{open:showParticipants,onClose:()=>setShowParticipants(false),fullWidth:true,maxWidth:\"sm\",children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[\"Participantes\",/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowParticipants(false),sx:{position:'absolute',right:8,top:8},children:/*#__PURE__*/_jsx(CloseIcon,{})})]}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(List,{children:selectedChat===null||selectedChat===void 0?void 0:(_selectedChat$partici=selectedChat.participants)===null||_selectedChat$partici===void 0?void 0:_selectedChat$partici.map(participant=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:participant.username[0].toUpperCase()})}),/*#__PURE__*/_jsx(ListItemText,{primary:participant.username})]},participant._id))})})]}),/*#__PURE__*/_jsx(PWAInstallPrompt,{})]});}// Desktop layout\nreturn/*#__PURE__*/_jsxs(Container,{maxWidth:\"lg\",sx:{mt:2,mb:2,height:'calc(100vh - 100px)'},children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{height:'100%'},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,children:/*#__PURE__*/_jsxs(Paper,{sx:{height:'100%',overflow:'hidden'},children:[/*#__PURE__*/_jsx(Box,{sx:{p:2,borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:\"Chats\"})}),/*#__PURE__*/_jsx(List,{sx:{overflowY:'auto',maxHeight:'calc(100% - 70px)'},children:chats.map(chat=>{var _chat$participants;return/*#__PURE__*/_jsxs(ListItem,{button:true,selected:(selectedChat===null||selectedChat===void 0?void 0:selectedChat._id)===chat._id,onClick:()=>setSelectedChat(chat),children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:chat.name[0].toUpperCase()})}),/*#__PURE__*/_jsx(ListItemText,{primary:chat.name,secondary:\"\".concat(((_chat$participants=chat.participants)===null||_chat$participants===void 0?void 0:_chat$participants.length)||0,\" participantes\")})]},chat._id);})})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:8,children:/*#__PURE__*/_jsxs(Paper,{sx:{height:'100%',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(Box,{sx:{p:2,borderBottom:1,borderColor:'divider',display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:(selectedChat===null||selectedChat===void 0?void 0:selectedChat.name)||'Selecciona un chat'}),selectedChat&&/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowParticipants(true),size:\"small\",children:/*#__PURE__*/_jsx(PeopleIcon,{})})]}),/*#__PURE__*/_jsxs(Box,{sx:{flexGrow:1,overflowY:'auto',p:2,bgcolor:'background.default'},children:[selectedChat?messages.map(renderMessage):/*#__PURE__*/_jsx(Box,{sx:{textAlign:'center',mt:4},children:/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"text.secondary\",children:\"Selecciona un chat para comenzar\"})}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),selectedChat&&/*#__PURE__*/_jsxs(Box,{sx:{p:2,borderTop:1,borderColor:'divider'},children:[/*#__PURE__*/_jsxs(ToggleButtonGroup,{value:inputMode,exclusive:true,onChange:(e,newMode)=>newMode&&setInputMode(newMode),size:\"small\",sx:{mb:1},children:[/*#__PURE__*/_jsx(ToggleButton,{value:\"text\",children:/*#__PURE__*/_jsx(KeyboardIcon,{})}),/*#__PURE__*/_jsx(ToggleButton,{value:\"audio\",children:/*#__PURE__*/_jsx(MicIcon,{})})]}),inputMode==='text'?/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleSendMessage,sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,size:\"small\",placeholder:\"Escribe un mensaje...\",value:newMessage,onChange:e=>setNewMessage(e.target.value)}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",disabled:!newMessage.trim(),startIcon:/*#__PURE__*/_jsx(SendIcon,{}),children:\"Enviar\"})]}):/*#__PURE__*/_jsx(AudioRecorder,{onSendAudio:handleSendAudio})]})]})})]}),/*#__PURE__*/_jsxs(Dialog,{open:showParticipants,onClose:()=>setShowParticipants(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsxs(DialogTitle,{children:[\"Participantes\",/*#__PURE__*/_jsx(IconButton,{onClick:()=>setShowParticipants(false),sx:{position:'absolute',right:8,top:8},children:/*#__PURE__*/_jsx(CloseIcon,{})})]}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(List,{children:selectedChat===null||selectedChat===void 0?void 0:(_selectedChat$partici2=selectedChat.participants)===null||_selectedChat$partici2===void 0?void 0:_selectedChat$partici2.map(participant=>/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:participant.username[0].toUpperCase()})}),/*#__PURE__*/_jsx(ListItemText,{primary:participant.username})]},participant._id))})})]}),/*#__PURE__*/_jsx(PWAInstallPrompt,{})]});};export default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","Container","Grid","Paper","Typography","Box","TextField","Button","List","ListItem","ListItemText","Divider","IconButton","Avatar","Dialog","DialogTitle","DialogContent","ListItemAvatar","useMediaQuery","useTheme","AppBar","Toolbar","ToggleButton","ToggleButtonGroup","Send","SendIcon","People","PeopleIcon","Close","CloseIcon","ArrowBack","ArrowBackIcon","Mic","MicIcon","Keyboard","KeyboardIcon","axios","useAuth","io","PWAInstallPrompt","AudioRecorder","AudioMessage","API_URL","jsx","_jsx","jsxs","_jsxs","Chat","_socketRef$current2","_selectedChat$partici2","user","theme","isMobile","breakpoints","down","chats","setChats","selectedChat","setSelectedChat","messages","setMessages","newMessage","setNewMessage","showParticipants","setShowParticipants","inputMode","setInputMode","messagesEndRef","socketRef","messageListenerRegistered","fetchChats","SOCKET_URL","process","env","REACT_APP_API_URL","console","log","current","on","id","disconnect","length","fetchMessages","_id","emit","socketExists","alreadyRegistered","message","_message$sender","_socketRef$current","content","audioUrl","messageType","sender","username","timestamp","Date","toISOString","socketId","prev","messageExists","some","msg","error","off","connected","res","get","data","chatId","concat","handleSendMessage","e","preventDefault","trim","userId","post","handleSendAudio","duration","audioDuration","response","status","renderMessage","isOwnMessage","sx","display","justifyContent","mb","px","children","maxWidth","flexDirection","alignItems","gap","width","height","bgcolor","fontSize","toUpperCase","variant","color","elevation","p","borderRadius","border","borderColor","wordBreak","mt","createdAt","toLocaleTimeString","hour","minute","scrollToBottom","_messagesEndRef$curre","scrollIntoView","behavior","_selectedChat$partici","position","edge","onClick","window","history","back","flexGrow","name","overflowY","map","ref","borderTop","component","onSubmit","fullWidth","size","placeholder","value","onChange","target","type","disabled","onSendAudio","open","onClose","right","top","participants","participant","primary","container","spacing","item","xs","md","overflow","borderBottom","maxHeight","chat","_chat$participants","button","selected","secondary","textAlign","exclusive","newMode","startIcon"],"sources":["/Users/lukasygina/image-share-app-1/client/src/pages/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  Container,\n  Grid,\n  Paper,\n  Typography,\n  Box,\n  TextField,\n  Button,\n  List,\n  ListItem,\n  ListItemText,\n  Divider,\n  IconButton,\n  Avatar,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  ListItemAvatar,\n  useMediaQuery,\n  useTheme,\n  AppBar,\n  Toolbar,\n  ToggleButton,\n  ToggleButtonGroup\n} from '@mui/material';\nimport {\n  Send as SendIcon,\n  People as PeopleIcon,\n  Close as CloseIcon,\n  ArrowBack as ArrowBackIcon,\n  Mic as MicIcon,\n  Keyboard as KeyboardIcon\n} from '@mui/icons-material';\nimport axios from 'axios';\nimport { useAuth } from '../context/AuthContext';\nimport io from 'socket.io-client';\nimport PWAInstallPrompt from '../components/PWAInstallPrompt';\nimport AudioRecorder from '../components/AudioRecorder';\nimport AudioMessage from '../components/AudioMessage';\nimport API_URL from '../utils/api';\n\nconst Chat = () => {\n  const { user } = useAuth();\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('md'));\n  \n  const [chats, setChats] = useState([]);\n  const [selectedChat, setSelectedChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [showParticipants, setShowParticipants] = useState(false);\n  const [inputMode, setInputMode] = useState('text'); // 'text' or 'audio'\n  const messagesEndRef = useRef();\n  const socketRef = useRef();\n  const messageListenerRegistered = useRef(false);\n\n  useEffect(() => {\n    fetchChats();\n    const SOCKET_URL = process.env.REACT_APP_API_URL || 'https://chat-app-backend-6e9b.onrender.com';\n    \n    console.log('ðŸ”„ Component mounting - Creating Socket.IO connection to:', SOCKET_URL);\n    socketRef.current = io(SOCKET_URL);\n\n    socketRef.current.on('connect', () => {\n      console.log('âœ… Socket.IO connected with ID:', socketRef.current.id);\n    });\n\n    socketRef.current.on('disconnect', () => {\n      console.log('âŒ Socket.IO disconnected');\n    });\n\n    return () => {\n      console.log('ðŸ”„ Component unmounting - Cleaning up Socket.IO connection');\n      if (socketRef.current) {\n        socketRef.current.disconnect();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (chats.length > 0 && !selectedChat) {\n      // Automatically select the first (and only) chat (Global Chat)\n      setSelectedChat(chats[0]);\n    }\n  }, [chats, selectedChat]);\n\n  useEffect(() => {\n    if (selectedChat) {\n      fetchMessages(selectedChat._id);\n      socketRef.current.emit('join', selectedChat._id);\n    }\n\n    return () => {\n      if (selectedChat) {\n        socketRef.current.emit('leave', selectedChat._id);\n      }\n    };\n  }, [selectedChat, isMobile]);\n\n  useEffect(() => {\n    // Only register listener once when socket is available\n    if (!socketRef.current || messageListenerRegistered.current) {\n      console.log('ðŸš« Skipping message listener registration:', {\n        socketExists: !!socketRef.current,\n        alreadyRegistered: messageListenerRegistered.current\n      });\n      return;\n    }\n\n    console.log('ðŸŽ¯ Registering message listener for the first time - Socket ID:', socketRef.current.id);\n    messageListenerRegistered.current = true;\n    \n    socketRef.current.on('message', (message) => {\n      console.log('ðŸ“¨ Received message via Socket.IO:', {\n        id: message._id,\n        content: message.content,\n        audioUrl: message.audioUrl,\n        messageType: message.messageType,\n        sender: message.sender?.username,\n        timestamp: new Date().toISOString(),\n        socketId: socketRef.current?.id\n      });\n      \n      if (message && message.sender && (message.content || message.audioUrl)) {\n        setMessages((prev) => {\n          // Check if message already exists to prevent duplicates\n          const messageExists = prev.some(msg => msg._id === message._id);\n          if (messageExists) {\n            console.log('ðŸš« Message already exists, not adding duplicate:', message._id);\n            return prev;\n          }\n          \n          console.log('âœ… Adding new message to state:', message._id);\n          return [...prev, message];\n        });\n      } else {\n        console.error('âŒ Invalid message structure received:', message);\n      }\n    });\n\n    // Cleanup function\n    return () => {\n      if (socketRef.current) {\n        console.log('ðŸ§¹ Cleaning up message listener for socket:', socketRef.current.id);\n        socketRef.current.off('message');\n        messageListenerRegistered.current = false;\n      }\n    };\n  }, [socketRef.current?.connected]);\n\n  const fetchChats = async () => {\n    try {\n      const res = await axios.get('/api/chats');\n      setChats(res.data);\n    } catch (error) {\n      console.error('Error fetching chats:', error);\n    }\n  };\n\n  const fetchMessages = async (chatId) => {\n    try {\n      const res = await axios.get(`/api/chats/${chatId}`);\n      setMessages(res.data.messages);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n    }\n  };\n\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    console.log('Sending message:', {\n      content: newMessage,\n      chatId: selectedChat._id,\n      userId: user._id\n    });\n\n    try {\n      const res = await axios.post(`/api/chats/${selectedChat._id}/messages`, {\n        content: newMessage\n      });\n      \n      console.log('Message sent successfully via HTTP:', res.data);\n      \n      // Don't manually add the message here - let Socket.IO handle it\n      // setMessages((prev) => [...prev, res.data]);\n      setNewMessage('');\n\n      // Don't emit via Socket.IO - the backend will handle this\n      // socketRef.current.emit('message', {\n      //   chatId: selectedChat._id,\n      //   message: res.data\n      // });\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  const handleSendAudio = async (audioUrl, duration) => {\n    try {\n      console.log('Sending audio message:', {\n        audioUrl,\n        duration,\n        chatId: selectedChat._id\n      });\n\n      const res = await axios.post(`${API_URL}/api/audio/chats/${selectedChat._id}/audio`, {\n        audioUrl,\n        audioDuration: duration\n      });\n      \n      console.log('Audio message sent successfully:', res.data);\n      \n    } catch (error) {\n      console.error('Error sending audio message:', error);\n      if (error.response) {\n        console.error('Error response:', error.response.data);\n        console.error('Error status:', error.response.status);\n      }\n    }\n  };\n\n  const renderMessage = (message) => {\n    // Add null checks to prevent errors\n    if (!message || !message.sender || !user) {\n      return null;\n    }\n    \n    const isOwnMessage = message.sender._id === user._id;\n    \n    return (\n      <Box\n        key={message._id}\n        sx={{\n          display: 'flex',\n          justifyContent: isOwnMessage ? 'flex-end' : 'flex-start',\n          mb: 2,\n          px: 1\n        }}\n      >\n        <Box\n          sx={{\n            maxWidth: isMobile ? '80%' : '60%',\n            display: 'flex',\n            flexDirection: isOwnMessage ? 'row-reverse' : 'row',\n            alignItems: 'flex-end',\n            gap: 1\n          }}\n        >\n          {!isOwnMessage && (\n            <Avatar\n              sx={{\n                width: 32,\n                height: 32,\n                bgcolor: 'primary.main',\n                fontSize: '0.875rem'\n              }}\n            >\n              {message.sender.username[0].toUpperCase()}\n            </Avatar>\n          )}\n          \n          <Box\n            sx={{\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: isOwnMessage ? 'flex-end' : 'flex-start',\n              maxWidth: '100%'\n            }}\n          >\n            {!isOwnMessage && (\n              <Typography\n                variant=\"caption\"\n                sx={{\n                  color: 'text.secondary',\n                  mb: 0.5,\n                  fontSize: '0.75rem'\n                }}\n              >\n                {message.sender.username}\n              </Typography>\n            )}\n            \n            {message.messageType === 'audio' ? (\n              <AudioMessage\n                audioUrl={message.audioUrl}\n                duration={message.audioDuration}\n                isOwnMessage={isOwnMessage}\n              />\n            ) : (\n              <Paper\n                elevation={1}\n                sx={{\n                  p: 1.5,\n                  bgcolor: isOwnMessage ? 'primary.main' : 'background.paper',\n                  color: isOwnMessage ? 'primary.contrastText' : 'text.primary',\n                  borderRadius: 2,\n                  border: 1,\n                  borderColor: isOwnMessage ? 'primary.main' : 'divider',\n                  wordBreak: 'break-word',\n                  maxWidth: '100%'\n                }}\n              >\n                <Typography variant=\"body2\">\n                  {message.content}\n                </Typography>\n              </Paper>\n            )}\n            \n            <Typography\n              variant=\"caption\"\n              sx={{\n                color: 'text.secondary',\n                mt: 0.5,\n                fontSize: '0.7rem'\n              }}\n            >\n              {new Date(message.createdAt).toLocaleTimeString([], {\n                hour: '2-digit',\n                minute: '2-digit'\n              })}\n            </Typography>\n          </Box>\n        </Box>\n      </Box>\n    );\n  };\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  if (isMobile) {\n    return (\n      <Box sx={{ height: '100vh', display: 'flex', flexDirection: 'column' }}>\n        {/* Mobile Header */}\n        <AppBar position=\"static\">\n          <Toolbar>\n            <IconButton\n              edge=\"start\"\n              color=\"inherit\"\n              onClick={() => window.history.back()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n            <Typography variant=\"h6\" sx={{ flexGrow: 1 }}>\n              {selectedChat?.name || 'Chat'}\n            </Typography>\n            <IconButton\n              color=\"inherit\"\n              onClick={() => setShowParticipants(true)}\n            >\n              <PeopleIcon />\n            </IconButton>\n          </Toolbar>\n        </AppBar>\n\n        {/* Messages Area */}\n        <Box\n          sx={{\n            flexGrow: 1,\n            overflowY: 'auto',\n            p: 1,\n            bgcolor: 'background.default'\n          }}\n        >\n          {messages.map(renderMessage)}\n          <div ref={messagesEndRef} />\n        </Box>\n\n        {/* Input Area */}\n        <Box sx={{ p: 2, bgcolor: 'background.paper', borderTop: 1, borderColor: 'divider' }}>\n          {inputMode === 'text' ? (\n            <Box component=\"form\" onSubmit={handleSendMessage} sx={{ display: 'flex', gap: 1 }}>\n              <TextField\n                fullWidth\n                size=\"small\"\n                placeholder=\"Escribe un mensaje...\"\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                sx={{ flexGrow: 1 }}\n              />\n              <IconButton\n                type=\"submit\"\n                color=\"primary\"\n                disabled={!newMessage.trim()}\n                sx={{ bgcolor: 'primary.main', color: 'white', '&:hover': { bgcolor: 'primary.dark' } }}\n              >\n                <SendIcon />\n              </IconButton>\n              <IconButton\n                onClick={() => setInputMode('audio')}\n                color=\"primary\"\n              >\n                <MicIcon />\n              </IconButton>\n            </Box>\n          ) : (\n            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n              <AudioRecorder onSendAudio={handleSendAudio} />\n              <Box sx={{ display: 'flex', justifyContent: 'center' }}>\n                <IconButton\n                  onClick={() => setInputMode('text')}\n                  color=\"primary\"\n                >\n                  <KeyboardIcon />\n                </IconButton>\n              </Box>\n            </Box>\n          )}\n        </Box>\n\n        {/* Participants Dialog */}\n        <Dialog\n          open={showParticipants}\n          onClose={() => setShowParticipants(false)}\n          fullWidth\n          maxWidth=\"sm\"\n        >\n          <DialogTitle>\n            Participantes\n            <IconButton\n              onClick={() => setShowParticipants(false)}\n              sx={{ position: 'absolute', right: 8, top: 8 }}\n            >\n              <CloseIcon />\n            </IconButton>\n          </DialogTitle>\n          <DialogContent>\n            <List>\n              {selectedChat?.participants?.map((participant) => (\n                <ListItem key={participant._id}>\n                  <ListItemAvatar>\n                    <Avatar>\n                      {participant.username[0].toUpperCase()}\n                    </Avatar>\n                  </ListItemAvatar>\n                  <ListItemText primary={participant.username} />\n                </ListItem>\n              ))}\n            </List>\n          </DialogContent>\n        </Dialog>\n\n        <PWAInstallPrompt />\n      </Box>\n    );\n  }\n\n  // Desktop layout\n  return (\n    <Container maxWidth=\"lg\" sx={{ mt: 2, mb: 2, height: 'calc(100vh - 100px)' }}>\n      <Grid container spacing={2} sx={{ height: '100%' }}>\n        {/* Chat List */}\n        <Grid item xs={12} md={4}>\n          <Paper sx={{ height: '100%', overflow: 'hidden' }}>\n            <Box sx={{ p: 2, borderBottom: 1, borderColor: 'divider' }}>\n              <Typography variant=\"h6\">Chats</Typography>\n            </Box>\n            <List sx={{ overflowY: 'auto', maxHeight: 'calc(100% - 70px)' }}>\n              {chats.map((chat) => (\n                <ListItem\n                  key={chat._id}\n                  button\n                  selected={selectedChat?._id === chat._id}\n                  onClick={() => setSelectedChat(chat)}\n                >\n                  <ListItemAvatar>\n                    <Avatar>\n                      {chat.name[0].toUpperCase()}\n                    </Avatar>\n                  </ListItemAvatar>\n                  <ListItemText\n                    primary={chat.name}\n                    secondary={`${chat.participants?.length || 0} participantes`}\n                  />\n                </ListItem>\n              ))}\n            </List>\n          </Paper>\n        </Grid>\n\n        {/* Chat Area */}\n        <Grid item xs={12} md={8}>\n          <Paper sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n            {/* Chat Header */}\n            <Box sx={{ p: 2, borderBottom: 1, borderColor: 'divider', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\n              <Typography variant=\"h6\">\n                {selectedChat?.name || 'Selecciona un chat'}\n              </Typography>\n              {selectedChat && (\n                <IconButton\n                  onClick={() => setShowParticipants(true)}\n                  size=\"small\"\n                >\n                  <PeopleIcon />\n                </IconButton>\n              )}\n            </Box>\n\n            {/* Messages Area */}\n            <Box\n              sx={{\n                flexGrow: 1,\n                overflowY: 'auto',\n                p: 2,\n                bgcolor: 'background.default'\n              }}\n            >\n              {selectedChat ? (\n                messages.map(renderMessage)\n              ) : (\n                <Box sx={{ textAlign: 'center', mt: 4 }}>\n                  <Typography variant=\"h6\" color=\"text.secondary\">\n                    Selecciona un chat para comenzar\n                  </Typography>\n                </Box>\n              )}\n              <div ref={messagesEndRef} />\n            </Box>\n\n            {/* Input Area */}\n            {selectedChat && (\n              <Box sx={{ p: 2, borderTop: 1, borderColor: 'divider' }}>\n                <ToggleButtonGroup\n                  value={inputMode}\n                  exclusive\n                  onChange={(e, newMode) => newMode && setInputMode(newMode)}\n                  size=\"small\"\n                  sx={{ mb: 1 }}\n                >\n                  <ToggleButton value=\"text\">\n                    <KeyboardIcon />\n                  </ToggleButton>\n                  <ToggleButton value=\"audio\">\n                    <MicIcon />\n                  </ToggleButton>\n                </ToggleButtonGroup>\n                \n                {inputMode === 'text' ? (\n                  <Box component=\"form\" onSubmit={handleSendMessage} sx={{ display: 'flex', gap: 1 }}>\n                    <TextField\n                      fullWidth\n                      size=\"small\"\n                      placeholder=\"Escribe un mensaje...\"\n                      value={newMessage}\n                      onChange={(e) => setNewMessage(e.target.value)}\n                    />\n                    <Button\n                      type=\"submit\"\n                      variant=\"contained\"\n                      disabled={!newMessage.trim()}\n                      startIcon={<SendIcon />}\n                    >\n                      Enviar\n                    </Button>\n                  </Box>\n                ) : (\n                  <AudioRecorder onSendAudio={handleSendAudio} />\n                )}\n              </Box>\n            )}\n          </Paper>\n        </Grid>\n      </Grid>\n\n      {/* Participants Dialog */}\n      <Dialog\n        open={showParticipants}\n        onClose={() => setShowParticipants(false)}\n        maxWidth=\"sm\"\n        fullWidth\n      >\n        <DialogTitle>\n          Participantes\n          <IconButton\n            onClick={() => setShowParticipants(false)}\n            sx={{ position: 'absolute', right: 8, top: 8 }}\n          >\n            <CloseIcon />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent>\n          <List>\n            {selectedChat?.participants?.map((participant) => (\n              <ListItem key={participant._id}>\n                <ListItemAvatar>\n                  <Avatar>\n                    {participant.username[0].toUpperCase()}\n                  </Avatar>\n                </ListItemAvatar>\n                <ListItemText primary={participant.username} />\n              </ListItem>\n            ))}\n          </List>\n        </DialogContent>\n      </Dialog>\n\n      <PWAInstallPrompt />\n    </Container>\n  );\n};\n\nexport default Chat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}